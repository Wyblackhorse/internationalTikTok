<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>axie小工具</title>
  <link href="assets/favicon.ico" rel="icon">
  <link rel="stylesheet" href="layui/css/layui.css">
  <script type="text/javascript" src="js/jquery-2.0.3.js"></script>
    <script type="text/javascript" src="js/xm-select.js"></script>
    <script type="text/javascript" src="js/FileSaver.js"></script>
  <style>

    .layui-table-cell{
        height: 70px;
        line-height: 70px;
    }

    .abilities_part1{
        position: relative;
        display: inline-block;
        margin: 20px 20px;
    }

    .abilities_name{
        position: absolute;
        top: 30px;
        left: 120px;
        color: #fff;
        font-weight: bold;
        font-size: 16px;
    }

    .abilities_detail{
        position: absolute;
        top: 270px;
        left: 60px;
        /*color: #fff;*/
        white-space: pre-wrap;
        width: 210px;

        color: rgb(204, 204, 204);
        font-weight: bold;
    }

    .abilities_image_small{
        position: absolute;
        top: 315px;
        left: 18px;
        width: 20px;
    }

  </style>
</head>
<body>

<div style="padding: 20px">


  <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
    <legend>筛选条件</legend>
  </fieldset>

  <div class="layui-bg-gray" style="padding: 30px;">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-header">能力展示(Abilities)</div>
                <div class="layui-card-body">
                    <div style="margin: 0 auto">
                        <div class="abilities_part1">
                            <span class="abilities_name" id="abilities_title1"></span>
                            <image src="" id="abilities_image1"></image>
                            <span class="abilities_detail" id="abilities_detail1"></span>
                            <image src="" class="abilities_image_small" id="abilities_image_small1"></image>
                        </div>
                        <div class="abilities_part1">
                            <span class="abilities_name" id="abilities_title2"></span>
                            <image src="" id="abilities_image2"></image>
                            <span class="abilities_detail" id="abilities_detail2"></span>
                            <image src="" class="abilities_image_small" id="abilities_image_small2"></image>
                        </div>
                        <div class="abilities_part1">
                            <span class="abilities_name" id="abilities_title3"></span>
                            <image src="" id="abilities_image3"></image>
                            <span class="abilities_detail" id="abilities_detail3"></span>
                            <image src="" class="abilities_image_small" id="abilities_image_small3"></image>
                        </div>
                        <div class="abilities_part1">
                            <span class="abilities_name" id="abilities_title4"></span>
                            <image src="" id="abilities_image4"></image>
                            <span class="abilities_detail" id="abilities_detail4"></span>
                            <image src="" class="abilities_image_small" id="abilities_image_small4"></image>
                        </div>
                    </div>

                </div>
            </div>
        </div>
      <div class="layui-col-md6">
        <div class="layui-card">
          <div class="layui-card-header">种类(CLASS)</div>
          <div class="layui-card-body">
            <form class="layui-form" action="" lay-filter="classform">
              <div class="layui-form-item">
<!--                <label class="layui-form-label">复选框</label>-->
                <div class="layui-input-block1">
                  <input type="checkbox" name="Beast" title="Beast" id="Beast" >
                  <input type="checkbox" name="Aquatic" title="Aquatic" id="Aquatic" >
                  <input type="checkbox" name="Plant" title="Plant" id="Plant" >
                  <input type="checkbox" name="Bird" title="Bird" id="Bird" >
                  <input type="checkbox" name="Bug" title="Bug" id="Bug" >
                  <input type="checkbox" name="Reptile" title="Reptile" id="Reptile" >
                  <input type="checkbox" name="Mech" title="Mech" id="Mech" >
                  <input type="checkbox" name="Dawn" title="Dawn" id="Dawn" >
                  <input type="checkbox" name="Dusk" title="Dusk" id="Dusk" >
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      <div class="layui-col-md6">
        <div class="layui-card">
          <div class="layui-card-header">能力(Parts)</div>
          <div class="layui-card-body">
              <div id="demo1" class="xm-select-demo"></div>
          </div>
        </div>
      </div>
    </div>

    <form class="layui-form" action="" lay-filter="classform" style="display: flex;margin-top: 20px;">
      <div class="layui-form-item" >
        <div class="layui-input-block1">

          <button type="submit" class="layui-btn" lay-submit="" lay-filter="addTempDb" id="addTempDb"><i class="layui-icon layui-icon-addition"></i> 模板入库</button>
            <button type="submit" class="layui-btn" lay-submit="" lay-filter="reloadWindowBtn" id="reloadWindowBtn" ><i class="layui-icon  layui-icon-refresh"></i> 重载当前窗口所有数据</button>
            <button type="submit" class="layui-btn" lay-submit="" lay-filter="searchBtn" id="searchBtn" ><i class="layui-icon layui-icon-refresh-1"></i> 重载相似数据</button>
<!--          <button type="submit" class="layui-btn" lay-submit="" lay-filter="editTempDb" id="editTempDb" style="float: right;margin-bottom: 10px"><i class="layui-icon layui-icon-edit"></i> 修改模板</button>-->


            <!--          <button type="submit" class="layui-btn layui-btn-primary">搜索(未实现)</button>-->
        </div>
      </div>
      <div class="layui-form-item" >
        <div class="layui-inline" >
            <label class="layui-form-label">模板列表:</label>
            <div class="layui-input-inline">
                <select name="templateList" id="templateList"  lay-filter="templateList">
                </select>
            </div>

        </div>

      </div>
    </form>
  </div>
<!--    <pre id="configCode"></pre>-->
    <div style="margin: 20px;">
        <label class="layui-form-label" style="width: 300px;color: red;font-weight: bold;text-align: left" id="shuoming"></label>
        <textarea placeholder="此处显示模板内容" class="layui-textarea" id="templateContext" rows="10" style="color: red;"></textarea>
    </div>
  <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
    <legend>筛选结果</legend>
  </fieldset>
  <span style="margin-left: 30px;">查询总数:</span><span class="layui-badge" id="totalNum" style="margin-left: 10px;">0</span>
<!--  <div class="layui-inline" style="margin-left: 30px">-->
<!--    <button type="submit" class="layui-btn" lay-submit="" lay-filter="goMasket" id="goMasket"><i class="layui-icon layui-icon-website"></i> 跳转市场</button>-->
<!--  </div>-->
  <table class="layui-hide" id="test" style="padding: 30px;"></table>


</div>



<script type="text/javascript" src="./js/conmon.js"></script>
<!-- 引入 layui.js 的 <script> 标签最好放置在 html 末尾 -->
<script src="layui/layui.js"></script>
<script>
    layui.use(function(){
     var layer = layui.layer
        ,form = layui.form
        ,laypage = layui.laypage
        ,element = layui.element
        ,laydate = layui.laydate
        ,$ = layui.jquery
        ,util = layui.util;

        var layuicode = layui.code
        var table = layui.table;

        var totalNumValue = 0


        var currParentDatas = eval('('+parent.jsondata+')')

        // console.log("currParentDatas",currParentDatas)

        var currQueryAxiesID = currParentDatas.axie_id



        var indexLoad = layer.load(1, {
            shade: [0.1,'#fff'] //0.1透明度的白色背景
        });

        //页面进来就读取数据
        $.ajax({
            url: requertUrl+"/getOneInformation?axieId="+currQueryAxiesID,
            type: "GET",
            dataType:"json",
            timeout : 5000, //超时时间设置，单位毫秒

            success: function (resultJson) {

                console.log('success-resultJson',resultJson)
                if(!resultJson.hasOwnProperty("data") && resultJson.hasOwnProperty("errors")){

                    layer.close(indexLoad)
                    layer.msg('查询异常,存在errors,请重新查询！', {icon: 2});
                    return false

                }


                let axie =  resultJson.data.axie

                if(axie == "undefined" || axie === null ){

                    // console.log("aaaaaa,没有值")
                    layer.closeAll()
                    // layer.msg("没有取到值,请确认宠物ID是否正确")
                    layer.msg('没有取到值,请确认宠物ID是否正确或502: Bad Gateway！', {icon: 2});
                    return false
                }

                let classStr =  resultJson.data.axie.class
                let partArrS =  resultJson.data.axie.parts


                if(classStr == "Beast"){
                    $("#Beast").prop("checked", true);

                    $("#Aquatic").prop("checked", false);
                    $("#Plant").prop("checked", false);
                    $("#Bird").prop("checked", false);
                    $("#Bug").prop("checked", false);
                    $("#Reptile").prop("checked", false);
                    $("#Mech").prop("checked", false);
                    $("#Dawn").prop("checked", false);
                    $("#Dusk").prop("checked", false);
                }

                if(classStr == "Aquatic"){
                    $("#Aquatic").prop("checked", true);

                    $("#Beast").prop("checked", false);
                    $("#Plant").prop("checked", false);
                    $("#Bird").prop("checked", false);
                    $("#Bug").prop("checked", false);
                    $("#Reptile").prop("checked", false);
                    $("#Mech").prop("checked", false);
                    $("#Dawn").prop("checked", false);
                    $("#Dusk").prop("checked", false);
                }

                if(classStr == "Plant"){
                    $("#Plant").prop("checked", true);
                    // $("#Plant").prop("checked", true);

                    $("#Beast").prop("checked", false);
                    $("#Aquatic").prop("checked", false);
                    $("#Bird").prop("checked", false);
                    $("#Bug").prop("checked", false);
                    $("#Reptile").prop("checked", false);
                    $("#Mech").prop("checked", false);
                    $("#Dawn").prop("checked", false);
                    $("#Dusk").prop("checked", false);

                }

                if(classStr == "Bird"){
                    $("#Bird").prop("checked", true);

                    $("#Beast").prop("checked", false);
                    $("#Aquatic").prop("checked", false);
                    $("#Plant").prop("checked", false);
                    $("#Bug").prop("checked", false);
                    $("#Reptile").prop("checked", false);
                    $("#Mech").prop("checked", false);
                    $("#Dawn").prop("checked", false);
                    $("#Dusk").prop("checked", false);
                }

                if(classStr == "Bug"){
                    $("#Bug").prop("checked", true);


                    $("#Beast").prop("checked", false);
                    $("#Aquatic").prop("checked", false);
                    $("#Plant").prop("checked", false);
                    $("#Bird").prop("checked", false);
                    $("#Reptile").prop("checked", false);
                    $("#Mech").prop("checked", false);
                    $("#Dawn").prop("checked", false);
                    $("#Dusk").prop("checked", false);


                }

                if(classStr == "Reptile"){
                    $("#Reptile").prop("checked", true);

                    $("#Beast").prop("checked", false);
                    $("#Aquatic").prop("checked", false);
                    $("#Plant").prop("checked", false);
                    $("#Bird").prop("checked", false);
                    $("#Bug").prop("checked", false);
                    $("#Mech").prop("checked", false);
                    $("#Dawn").prop("checked", false);
                    $("#Dusk").prop("checked", false);


                }

                if(classStr == "Mech"){
                    $("#Mech").prop("checked", true);

                    $("#Beast").prop("checked", false);
                    $("#Aquatic").prop("checked", false);
                    $("#Plant").prop("checked", false);
                    $("#Bird").prop("checked", false);
                    $("#Bug").prop("checked", false);
                    $("#Reptile").prop("checked", false);
                    $("#Dawn").prop("checked", false);
                    $("#Dusk").prop("checked", false);


                }

                if(classStr == "Dawn"){
                    $("#Dawn").prop("checked", true);


                    $("#Beast").prop("checked", false);
                    $("#Aquatic").prop("checked", false);
                    $("#Plant").prop("checked", false);
                    $("#Bird").prop("checked", false);
                    $("#Bug").prop("checked", false);
                    $("#Reptile").prop("checked", false);
                    $("#Mech").prop("checked", false);
                    $("#Dusk").prop("checked", false);
                }

                if(classStr == "Dusk"){

                    $("#Dusk").prop("checked", true);

                    $("#Beast").prop("checked", false);
                    $("#Aquatic").prop("checked", false);
                    $("#Plant").prop("checked", false);
                    $("#Bird").prop("checked", false);
                    $("#Bug").prop("checked", false);
                    $("#Reptile").prop("checked", false);
                    $("#Mech").prop("checked", false);
                    $("#Dawn").prop("checked", false);
                }

                // console.log(partArrS[0].abilities.length)

                $("#Yam").prop("checked", false);
                $("#Humorless").prop("checked", false);
                $("#RoseBud").prop("checked", false);
                $("#Eggshell").prop("checked", false);
                $("#Hasagi").prop("checked", false);
                $("#Shiitake").prop("checked", false);
                $("#FirTrunk").prop("checked", false);
                $("#NutCracker").prop("checked", false);

                var valueSelectArray = []

                var queryEyesStr;
                var queryEarsStr;
                var queryBackStr;
                var queryMouthStr;
                var queryHornStr;
                var queryTailStr;


                partArrS.forEach((item,index)=>{

                    if(item.type == "Eyes"){
                        // console.log("当前技能ID",item.id)
                        $("#eye").prop("checked", true);
                        $("#input_eye").val(item.id)
                        // $("#earsSpan").text(item.name)
                        queryEyesStr = item.name
                        eyeID = item.id
                        valueSelectArray.push(eyeID)
                    }

                    if(item.type == "Ears"){
                        // console.log("当前技能ID",item.id)
                        $("#ear").prop("checked", true);
                        $("#input_ear").val(item.id)
                        queryEarsStr = item.name
                        earID = item.id
                        valueSelectArray.push(earID)
                    }


                    if(item.abilities.length !== 0){


                        if(item.type == "Back"){
                            // console.log("当前技能ID",item.id)
                            bacID = item.id
                            $("#input_back").val(item.id)
                            queryBackStr = item.name
                            $("#back").prop("checked", true);

                            valueSelectArray.push(bacID)


                            $("#abilities_title1").text(item.abilities[0].name)

                            $("#abilities_detail1").text(item.abilities[0].description)
                            $("#abilities_image1").attr('src',item.abilities[0].backgroundUrl);
                            $("#abilities_image_small1").attr('src',item.abilities[0].effectIconUrl);


                            // if(item.id == "back-risky-beast"){  //黄颜色的背部
                            //   $("#Hasagi").prop("checked", true);
                            // }else{
                            //   $("#Shiitake").prop("checked", true);
                            // }
                        }

                        if(item.type == "Mouth"){

                            mouthID = item.id
                            $("#input_mouth").val(item.id)
                            queryMouthStr = item.name
                            $("#mouth").prop("checked", true);
                            valueSelectArray.push(mouthID)

                            $("#abilities_title2").text(item.abilities[0].name)
                            $("#abilities_detail2").text(item.abilities[0].description)
                            $("#abilities_image2").attr('src',item.abilities[0].backgroundUrl);
                            $("#abilities_image_small2").attr('src',item.abilities[0].effectIconUrl);


                            // // console.log("当前技能ID",item.id)
                            // if(item.id == "mouth-humorless"){
                            //   $("#Humorless").prop("checked", true);
                            // }else{
                            //   $("#NutCracker").prop("checked", true);
                            // }
                        }

                        if(item.type == "Horn"){
                            hornID = item.id
                            $("#input_horn").val(item.id)
                            queryHornStr = item.name
                            $("#horn").prop("checked", true);
                            valueSelectArray.push(hornID)

                            $("#abilities_title3").text(item.abilities[0].name)
                            $("#abilities_detail3").text(item.abilities[0].description)
                            $("#abilities_image3").attr('src',item.abilities[0].backgroundUrl);
                            $("#abilities_image_small3").attr('src',item.abilities[0].effectIconUrl);


                            // console.log("当前技能ID",item.id)
                            // if(item.id == "horn-rose-bud"){
                            //   $("#RoseBud").prop("checked", true);
                            // }else{
                            //   $("#Eggshell").prop("checked", true);
                            // }
                        }

                        // if(item.type == "Beast"){
                        //   // console.log("当前技能ID",item.id)
                        //
                        // }

                        if(item.type == "Tail"){
                            tailID = item.id
                            queryTailStr = item.name
                            $("#input_tail").val(item.id)
                            $("#tail").prop("checked", true);
                            valueSelectArray.push(tailID)

                            $("#abilities_title4").text(item.abilities[0].name)
                            $("#abilities_detail4").text(item.abilities[0].description)
                            $("#abilities_image4").attr('src',item.abilities[0].backgroundUrl);
                            $("#abilities_image_small4").attr('src',item.abilities[0].effectIconUrl);


                            // if(item.id == "tail-yam"){
                            //   $("#Yam").prop("checked", true);
                            // }else{
                            //   $("#FirTrunk").prop("checked", true);
                            // }
                        }
                    }




                    demo2.setValue(valueSelectArray)



                })


                // console.log("valueSelectArray",valueSelectArray)




                form.render('checkbox')
                layer.closeAll()


                //查完能力接着 查找相似
                // var indexTableLoad = layer.load(1, {
                //     shade: [0.1,'#fff'] //0.1透明度的白色背景
                // });

                //因数据加载可能存在不及时回来,得开启定时器进行判断
                var timerSetInterval = setInterval(()=>{

                    let selectArr = demo2.getValue("valueStr");
                    selectArr =  selectArr.replaceAll(",", "@");
                    // console.log("selectArr",selectArr,selectArr.length)


                    if(selectArr != "" || selectArr.length != 0){

                        // console.log("selectArr不为空!",)
                        //selectArr不为空,则清除定时器,并进行页面重载
                        clearInterval(timerSetInterval)
                        var data = form.val('classform');

                        // console.log(data)

                        classStr =""

                        if(data.Beast == "on"){
                            // console.log("进来")
                            classStr = classStr + "Beast" + "@"
                        }

                        if(data.Aquatic == "on"){
                            classStr = classStr + "Aquatic" + "@"
                        }

                        if(data.Plant == "on"){
                            classStr = classStr + "Plant" + "@"
                        }

                        if(data.Bird == "on"){
                            classStr = classStr + "Bird" + "@"
                        }

                        if(data.Bug == "on"){
                            classStr = classStr + "Bug" + "@"
                        }

                        if(data.Reptile == "on"){
                            classStr = classStr + "Reptile" + "@"
                        }

                        if(data.Mech == "on"){
                            classStr = classStr + "Mech" + "@"
                        }

                        if(data.Dawn == "on"){
                            classStr = classStr + "Dawn" + "@"
                        }

                        if(data.Dusk == "on"){
                            classStr = classStr + "Dusk" + "@"
                        }

                        classStr = classStr.substring(0,classStr.length-1);

                        //
                        // //查找相似ajax请求方法
                        // $.ajax({
                        //     url:requertUrl+"/setInformation",
                        //     type: "GET",
                        //     dataType:"json",
                        //     timeout : 5000, //超时时间设置，单位毫秒
                        //     success: function (res) {
                        //         var resData
                        //         console.log("当前res",res)
                        //         console.log("当前查找ID相似",currQueryAxiesID)
                        //
                        //         if(res.result === null || res.result == "null"){
                        //             layer.close(indexTableLoad)
                        //             console.log("res.result为null的情况,看返回来的数据--",res)
                        //             layer.msg('查找相似失败,res.result为null,请重新查找相似~', {icon: 2});
                        //             // return {
                        //             //     "code":200,
                        //             //     "result": null //解析数据列表
                        //             // };
                        //
                        //             resData = []
                        //
                        //         }else{
                        //             if(res.result.data === undefined || res.result.data == 'undefined' || res.result.data === null || res.result.data == "null" ){
                        //
                        //                 layer.close(indexTableLoad)
                        //                 layer.msg('查找相似失败,res.result.data为null,请重新查找相似~', {icon: 2});
                        //                 console.log("res.result.data为null的情况,看返回来的数据--",res)
                        //
                        //             }else{
                        //
                        //                 console.log("看返回来的数据",res.result.data)
                        //
                        //
                        //                 if(res.result.data.hasOwnProperty('axies') && !res.result.data.hasOwnProperty('errors')){
                        //                     //这里有点小问题
                        //                     $("#totalNum").text(res.result.data.axies.total)
                        //                     layer.close(indexTableLoad)
                        //                     // return {
                        //                     //     "code":200,
                        //                     //     "result": res.result.data.axies.results //解析数据列表
                        //                     // };
                        //
                        //                     resData =  res.result.data.axies.results
                        //                 }else{
                        //                     layer.close(indexTableLoad)
                        //                     $("#totalNum").text("总数异常错误")
                        //                     // return {
                        //                     //     "code":200,
                        //                     //     "result": res.result.data.errors //解析数据列表
                        //                     // };
                        //
                        //                     resData =  res.result.data.errors
                        //                 }
                        //
                        //             }
                        //         }
                        //
                        //
                        //
                        //         //先进行ajax请求,在进行执行重载
                        //         table.reload('systemLog', {
                        //             page: {
                        //                 curr: 1 //重新从第 1 页开始
                        //             },
                        //             // url : requertUrl+"/setInformation"
                        //             data: resData
                        //             ,where: {
                        //                 classes: classStr,
                        //                 parts:selectArr
                        //             } ,
                        //             parseData: function(res){ //res 即为原始返回的数据
                        //
                        //
                        //
                        //             },
                        //             done: function(res, curr, count){
                        //                 if(res.result === null || res.result == "null"){
                        //                     layer.close(indexTableLoad)
                        //                     console.log("res.result为null的情况,看返回来的数据--",res)
                        //                     layer.msg('查找相似失败,res.result为null,请重新查找相似~', {icon: 2});
                        //                 }else{
                        //                     layer.msg('查找相似已查询成功~', {icon: 1});
                        //                     // layer.close(indexTableLoad)
                        //                 }
                        //
                        //             },
                        //             error:function(error,res){
                        //                 console.log("reload--error",error)
                        //                 console.log("reload--res",res)
                        //                 // layer.msg('查找相似已查询成功~', {icon: 1});
                        //                 // layer.close(indexTableLoad)
                        //             },
                        //         });
                        //     },
                        //     error : function(XMLHttpRequest,status){ //请求失败执行函数
                        //
                        //         console.log("ajax-error",status)
                        //         layer.close(indexLoad)
                        //         layer.msg('查找相似失败,,axie服务器没响应,请重新查询！', {icon: 2});
                        //
                        //
                        //     },
                        //     complete : function(XMLHttpRequest,status){ //请求完成后最终执行参数
                        //
                        //         // console.log("status",status)
                        //         if(status == 'timeout'){//超时,status还有success,error等值的情况
                        //
                        //             layer.close(indexLoad)
                        //             layer.msg('查找相似失败,,axie服务器没响应,请重新查询！', {icon: 2});
                        //             return false
                        //             // alert("超时");
                        //
                        //         }
                        //
                        //     },
                        //
                        //
                        //
                        // });


                        //执行重载
                        table.reload('systemLog', {
                            page: {
                                curr: 1 //重新从第 1 页开始
                            },
                            url : requertUrl+"/setInformation"
                            ,where: {
                                classes: classStr,
                                parts:selectArr
                            } ,
                            parseData: function(res){ //res 即为原始返回的数据
                                console.log("当前res",res)
                                console.log("当前查找ID相似",currQueryAxiesID)

                                if(res.result === null || res.result == "null"){
                                    // layer.close(indexTableLoad)
                                    console.log("res.result为null的情况,看返回来的数据--",res)
                                    layer.msg('查找相似失败,res.result为null,请重新查找相似~', {icon: 2});
                                    return {
                                        "code":200,
                                        "result": null //解析数据列表
                                    };
                                }else{
                                    if(res.result.data === undefined || res.result.data == 'undefined' || res.result.data === null || res.result.data == "null" ){

                                        // layer.close(indexTableLoad)
                                        layer.msg('查找相似失败,res.result.data为null,请重新查找相似~', {icon: 2});
                                        console.log("res.result.data为null的情况,看返回来的数据--",res)

                                    }else{

                                        console.log("看返回来的数据",res.result.data)


                                        if(res.result.data.hasOwnProperty('axies') && !res.result.data.hasOwnProperty('errors')){
                                            //这里有点小问题
                                            totalNumValue = res.result.data.axies.total
                                            $("#totalNum").text(res.result.data.axies.total)
                                            // layer.close(indexTableLoad)
                                            return {
                                                "code":200,
                                                "result": res.result.data.axies.results //解析数据列表
                                            };
                                        }else{
                                            // layer.close(indexTableLoad)
                                            $("#totalNum").text("总数异常错误")
                                            return {
                                                "code":200,
                                                "result": res.result.data.errors //解析数据列表
                                            };
                                        }

                                    }
                                }






                            },
                            done: function(res, curr, count){
                                if(res.result === null || res.result == "null"){
                                    // layer.close(indexTableLoad)
                                    console.log("res.result为null的情况,看返回来的数据--",res)
                                    layer.msg('查找相似失败,res.result为null,请重新查找相似~', {icon: 2});
                                }else{
                                    layer.msg('查找相似已查询成功~', {icon: 1});
                                    // layer.close(indexTableLoad)
                                }

                            },
                            error:function(error,res){
                                console.log("reload--error",error)
                                console.log("reload--res",res)
                                // layer.msg('查找相似已查询成功~', {icon: 1});
                                // layer.close(indexTableLoad)
                            },
                        });



                    }else{ //selectArr为空,则继续进行定时任务查找
                        // console.log("selectArr为空!",)
                    }

                },1000)


                var requestdata = "w="+JSON.stringify({"data":[{"class":classStr,"eyes":queryEyesStr,"ears":queryEarsStr,"back":queryBackStr,"mouth":queryMouthStr,"horn":queryHornStr,"tail":queryTailStr}]})

                // console.log(requestdata)
                //查询模板是否存在
                $.ajax({
                    url: requertUrl+"/IfShopping",
                    dataType: 'json',
                    type: 'POST',
                    data:requestdata,
                    // contentType:"application/x-www-form-urlencoded",
                    // contentType: "application/json; charset=utf-8",
                    // data: JSON.stringify(requestdata),
                    success: function (dataArray) {

                        // console.log(dataArray)
                        if (dataArray.code != 200) {

                            // console.log(dataArray.msg)
                            // layer.msg(dataArray.msg);
                            $("#shuoming").text("模板不存在")
                            layer.msg("模板不存在！", {icon: 1});
                            $("#templateContext").val("")
                            return false;

                        }



                        layer.msg("此模板已经存在！", {icon: 2});

                        $("#shuoming").text("此模板已经存在！")
                        var currTempDatas = dataArray.result

                        // currTempDatas

                        $('#templateList').find('option:contains(' + currTempDatas.remark + ')').prop('selected',true);
                        //重新渲染 固定写法
                        form.render("select");


                        currDatas_template = currTempDatas

                        var filecontent = "# 以下信息为模板的信息" + "\n"
                        filecontent = filecontent + "类别 = " + currTempDatas.kinds + "\n"
                        filecontent = filecontent + "眼睛 = " + currTempDatas.eyes+ "\n"
                        filecontent = filecontent + "耳朵 = " + currTempDatas.ears + "\n"
                        filecontent = filecontent + "背 = " + currTempDatas.back + "\n"
                        filecontent = filecontent + "牙 = " + currTempDatas.mouth+ "\n"
                        filecontent = filecontent + "角 = " + currTempDatas.horn+ "\n"
                        filecontent = filecontent + "尾 = " + currTempDatas.tail+ "\n"
                        filecontent = filecontent + "价格(ETH) = " + currTempDatas.eth_price+ "\n"
                        filecontent = filecontent + "价格(USD) = " + currTempDatas.price+ "\n"

                        $("#templateContext").val(filecontent)



                        //如果模板已存在后就删除市场中的ID
                        $.ajax({
                        	url: requertUrl+"/delRec?id="+currParentDatas.id,
                        	dataType: 'json',
                        	type: 'GET',
                        	success: function (dataArray) {

                        		// console.log(dataArray)
                        		if (dataArray.code != 200) {

                        			// console.log(dataArray.msg)
                        			// layer.msg(dataArray.msg);

                        			return false;

                        		}

                                layer.closeAll();
                                // window.parent.location.reload();

                        	}
                        })

                    }
                })

            },
            error : function(XMLHttpRequest,status){ //请求失败执行函数

                console.log("ajax-error",status)
                layer.close(indexLoad)
                layer.msg('查询错误,axie服务器没响应,请重新查询！', {icon: 2});


            },
            complete : function(XMLHttpRequest,status){ //请求完成后最终执行参数

                // console.log("status",status)
                if(status == 'timeout'){//超时,status还有success,error等值的情况

                    layer.close(indexLoad)
                    layer.msg('查询失败,axie服务器没响应,请重新查询！', {icon: 2});
                    return false
                    // alert("超时");

                }

            },



        });


        //获取模板列表添加到下拉框中
        $.ajax({
            url: requertUrl+"/getWcModel",
            dataType: 'json',
            type: 'GET',
            success: function (dataArray) {

                // console.log(dataArray)
                if (dataArray.code != 200) {

                    // console.log(dataArray.msg)
                    // layer.msg(dataArray.msg);

                    return false;

                }

                allJsonOBJ = dataArray.msg

                var returnDataArray = dataArray.msg
                // currSelectReturnDataArray= returnDataArray
                // var currAccountID = returnDataArray[0].id
                // var currAccountTokenValue = returnDataArray[0]['token_value']
                // currSelectReturnID = currAccountID
                // currSelectReturnTokenValue= currAccountTokenValue
                // console.log("returnDataArray",returnDataArray)

                $("#templateList").empty();
                $('#templateList').append(new Option("请选择模板","9999999"));
                $.each(returnDataArray, function (index, item) {
                    $('#templateList').append(new Option(item.remark, item.remark));// 下拉菜单里添加元素

                });

                // $("#templateList").attr("selected", "selected");

                //重新渲染 固定写法
                form.render("select");






            }
        })



        var newTemplateObj;
        var queryParamObj;

        var eyeID = ""
        var earID =""
        var bacID = ""
        var mouthID = ""
        var hornID = ""
        var tailID = ""
        var goUrlStr = ""
        var classStr = ""


        var eyeIDStrS = ""
        var earIDStrS =""
        var backIDStrS = ""
        var mouthIDStrS = ""
        var hornIDStrS = ""
        var tailIDStrS = ""

        var currQueryID = null

        var allJsonOBJ = null
        var currDatas_template

        var allData = [
            { name:"Blossom", value:"eyes-blossom"},
            { name:"Bookworm", value:"eyes-bookworm"},
            { name:"Broken Bookworm", value:"eyes-broken-bookworm"},
            { name:"Calico Zeal", value:"eyes-calico-zeal"},
            { name:"Chubby", value:"eyes-chubby"},
            { name:"Clear", value:"eyes-clear"},
            { name:"Confused", value:"eyes-confused"},
            { name:"Crimson Gecko", value:"eyes-crimson-gecko"},
            { name:"Cucumber Slice", value:"eyes-cucumber-slice"},
            { name:"Dokuganryu", value:"eyes-dokuganryu"},
            { name:"Dreamy Papi", value:"eyes-eyes-dreamy-papi"},
            { name:"Gecko", value:"eyes-gecko"},
            { name:"Gero", value:"eyes-gero"},
            { name:"lcy Gaze", value:"eyes-icy-gaze"},
            { name:"Insomnia", value:"eyes-insomnia"},
            { name:"Kabuki", value:"eyes-kabuki"},
            { name:"Kotaro", value:"eyes-kotaro"},
            { name:"Little Owl", value:"eyes-little-owl"},
            { name:"Little Peas", value:"eyes-little-peas"},
            { name:"Lucas", value:"eyes-lucas"},
            { name:"Mavis", value:"eyes-mavis"},
            { name:"Neo", value:"eyes-neo"},
            { name:"Nerdy", value:"eyes-nerdy"},
            { name:"Papi", value:"eyes-papi"},
            { name:"Puppy", value:"eyes-puppy"},
            { name:"Robin", value:"eyes-robin"},
            { name:"Scar", value:"eyes-scar"},
            { name:"Sky Mavis", value:"eyes-sky-mavis"},
            { name:"Sleepless", value:"eyes-sleepless"},
            { name:"Snowflakes", value:"eyes-snowflakes"},
            { name:"Telescope", value:"eyes-telescope"},
            { name:"Topaz", value:"eyes-topaz"},
            { name:"Tricky", value:"eyes-tricky"},
            { name:"Yen", value:"eyes-yen"},
            { name:"Zeal", value:"eyes-zeal"},

            { name:"Beetle Spike", value:"ears-beetle-spike"},
            { name:"Belieber", value:"ears-belieber"},
            { name:"Bubblemaker", value:"ears-bubblemaker"},
            { name:"Clover", value:"ears-clover"},
            { name:"Curly", value:"ears-curly"},
            { name:"Curved Spine", value:"ears-curved-spine"},
            { name:"Deadly Pogona", value:"ears-deadly-pogona"},
            { name:"Ear Breathing", value:"ears-ear-breathing"},
            { name:"Early Bird", value:"ears-early-bird"},
            { name:"Earwing", value:"ears-earwing"},
            { name:"Friezard", value:"ears-friezard"},
            { name:"Gill", value:"ears-gill"},
            { name:"Heart Cheek", value:"ears-heart-cheek"},
            { name:"Hollow", value:"ears-hollow"},
            { name:"Inkling", value:"ears-inkling"},
            { name:"Innocent Lamb", value:"ears-innocent-lamb"},
            { name:"Karimata", value:"ears-karimata"},
            { name:"Larva", value:"ears-larva"},
            { name:"Leaf Bug", value:"ears-leaf-bug"},
            { name:"Leafy", value:"ears-leafy"},
            { name:"Lotus", value:"ears-lotus"},
            { name:"Maiko", value:"ears-maiko"},
            { name:"Merry Lamb", value:"ears-merry-lamb"},
            { name:"Mon", value:"ears-mon"},
            { name:"Nimo", value:"ears-nimo"},
            { name:"Nut Cracker", value:"ears-nut-cracker"},
            { name:"Nyan", value:"ears-nyan"},
            { name:"Owl", value:"ears-owl"},
            { name:"Peace Maker", value:"ears-peace-maker"},
            { name:"Pinecones", value:"ears-pinecones"},
            { name:"Pink Cheek", value:"ears-pink-cheek"},
            { name:"Pogona", value:"ears-pogona"},
            { name:"Pointy Nyan", value:"ears-pointy-nyan"},
            { name:"Puppy", value:"ears-puppy"},
            { name:"Red Nimo", value:"ears-red-nimo"},
            { name:"Risky Bird", value:"ears-risky-bird"},
            { name:"Rosa", value:"ears-rosa"},
            { name:"Sakura", value:"ears-sakura"},
            { name:"Seaslug", value:"ears-seaslug"},
            { name:"Sidebarb", value:"ears-sidebarb"},
            { name:"Small Frill", value:"ears-small-frill"},
            { name:"Swirl", value:"ears-swirl"},
            { name:"Tassels", value:"ears-tassels"},
            { name:"The Last Leaf", value:"ears-the-last-leaf"},
            { name:"Tiny Fan", value:"ears-tiny-fan"},
            { name:"Vector", value:"ears-vector"},
            { name:"Zen", value:"ears-zen"},

            { name:"Axie Kiss(Death Mark)", value:"mouth-axie-kiss"},
            { name:"Catfish(Swallow)", value:"mouth-catfish"},
            { name:"Confident(Self Rally)", value:"mouth-confident"},
            { name:"Cute Bunny(Terror Chomp)", value:"mouth-cute-bunny"},
            { name:"Dango(Chomp)", value:"mouth-dango"},
            { name:"Doubletalk(Soothing Song)", value:"mouth-doubletalk"},
            { name:"Feasting Mosquito(Feasting MosquitoBlood Taste)", value:"mouth-feasting-mosquito"},
            { name:"Geisha(Crimson Water)", value:"mouth-geisha"},
            { name:"Goda(Piercing Sound)", value:"mouth-goda"},
            { name:"Herbivore(Vegan Diet)", value:"mouth-herbivore"},
            { name:"Humorless(HumorlessVegetal Bite)", value:"mouth-humorless"},
            { name:"Hungry Bird(lnsectivore)", value:"mouth-hungry-bird"},
            { name:"Kawaii(Terror Chomp)", value:"mouth-kawaii"},
            { name:"Kotaro(Kotaro bite)", value:"mouth-kotaro"},
            { name:"Lam(Angry Lam)", value:"mouth-lam"},
            { name:"Lam Handsome(Angry Lam)", value:"mouth-lam-handsome"},
            { name:"Little Owl(Dark Swoop)", value:"mouth-little-owl"},
            { name:"Mosquito(Blood Taste)", value:"mouth-mosquito"},
            { name:"Mr. Doubletalk(Soothing Song)", value:"mouth-mr-doubletalk"},
            { name:"Nut Cracker(Nut Crack)", value:"mouth-nut-cracker"},
            { name:"Peace Maker(Peace Treaty)", value:"mouth-peace-maker"},
            { name:"Pincer(Sunder Claw)", value:"mouth-pincer"},
            { name:"Piranha(Crimson Water)", value:"mouth-piranha"},
            { name:"Razor Bite(Why So Serious)", value:"mouth-razor-bite"},
            { name:"Risky Fish(Fish Hook)", value:"mouth-risky-fish"},
            { name:"Rudolph(Drain Bite)", value:"mouth-rudolph"},
            { name:"Serious(Vegetal Bite)", value:"mouth-serious"},
            { name:"Silence Whisper(Forest Spirit)", value:"mouth-silence-whisper"},
            { name:"Skull Cracker(Nut Crack)", value:"mouth-skull-cracker"},
            { name:"Square Teeth(Mite Bite)", value:"mouth-square-teeth"},
            { name:"Tiny Carrot(Chomp)", value:"mouth-tiny-carrot"},
            { name:"Tiny Turtle(Chomp)", value:"mouth-tiny-turtle"},
            { name:"Toothless Bite(Sneaky Raid)", value:"mouth-toothless-bite"},
            { name:"Venom Bite(Sneaky Raid)", value:"mouth-venom-bite"},
            { name:"Zigzag(Drain Bite)", value:"mouth-zigzag"},

            { name:"5H04L-5T4R(Star Shuriken)", value:"horn-5h04l-5t4r"},
            { name:"Anemone(Aquaponics)", value:"horn-anemone"},
            { name:"Antenna(Bug Signal)", value:"horn-antenna"},
            { name:"Arco(Acrobatic)", value:"horn-arco"},
            { name:"Babylonia(Shell Jab)", value:"horn-babylonia"},
            { name:"Bamboo Shoot(Bamboo Clan)", value:"horn-bamboo-shoot"},
            { name:"Beech(Wooden Stab)", value:"horn-beech"},
            { name:"Bumpy(Overgrow Keratin)", value:"horn-bumpy"},
            { name:"Cactus(Prickly Trap)", value:"horn-cactus"},
            { name:"Candy Babylonia(Shell Jab)", value:"horn-candy-babylonia"},
            { name:"Caterpillars(Grub Surprise)", value:"horn-caterpillars"},
            { name:"Cerastes(Surprise Invasion)", value:"horn-cerastes"},
            { name:"Clamshell(Clam Slash)", value:"horn-clamshell"},
            { name:"Cuckoo(Cockadoodledoo)", value:"horn-cuckoo"},
            { name:"Dual Blade(Sinister Strike)", value:"horn-dual-blade"},
            { name:"Eggshell(Eggbomb)", value:"horn-eggshell"},
            { name:"Feather Spear(Feather Lunge)", value:"horn-feather-spear"},
            { name:"Golden Bamboo Shoot(Bamboo Clan)", value:"horn-golden-bamboo-shoot"},
            { name:"Golden Shell(Eggbomb)", value:"horn-golden-shell"},
            { name:"Imp(lvory Stab)", value:"horn-imp"},
            { name:"Incisor(Disarm)", value:"horn-incisor"}, //这个好像忘记了
            { name:"Kendama(lvory Stab)", value:"horn-kendama"},
            { name:"Kestrel(Headshot)", value:"horn-kestrel"},
            { name:"Lagging(Mystic Rush)", value:"horn-lagging"},
            { name:"Laggingggggg(Mystic Rush)", value:"horn-laggingggggg"},
            { name:"Leaf Bug(Disguise)", value:"horn-leaf-bug"},
            { name:"Little Branch(Branch Charge)", value:"horn-little-branch"},
            { name:"Merry(Merry Legion)", value:"horn-merry"},
            { name:"Oranda(Hero's Bane)", value:"horn-oranda"},
            { name:"P4R451T3(Third Glance)", value:"horn-p4r451t3"},
            { name:"Parasite(Third Glance)", value:"horn-parasite"},
            { name:"Pinku Unko(Poo Fling)", value:"horn-pinku-unko"},
            { name:"Pliers(Dull Grip)", value:"horn-pliers"},
            { name:"Pocky(Sugar Rush)", value:"horn-pocky"},
            { name:"Rose Bud(Healing Aroma)", value:"horn-rose-bud"},
            { name:"Santas Gift(Prickly Trap)", value:"horn-santas-gift"},
            { name:"Scaly Spear(Scaly Lunge)", value:"horn-scaly-spear"},
            { name:"Scaly Spoon(Tiny Catapult)", value:"horn-scaly-spoon"},
            { name:"Shoal Star(Star Shuriken)", value:"horn-shoal-star"},
            { name:"Spruce Spear(Feather Lunge)", value:"horn-spruce-spear"},
            { name:"Strawberry Shortcake(Sweet Party)", value:"horn-strawberry-shortcake"},
            { name:"Teal Shell(Deep Sea Gore)", value:"horn-teal-shell"},
            { name:"Trump(Air Force One)", value:"horn-trump"},
            { name:"Umaibo(Sugar Rush)", value:"horn-umaibo"},
            { name:"Unko(Poo Fling)", value:"horn-unko"},
            { name:"Watermelon(Seed Bullet)", value:"horn-watermelon"},
            { name:"Wing Horn(Smart Shot)", value:"horn-wing-horn"},
            { name:"Winter Branch(Branch Charge)", value:"horn-winter-branch"},
            { name:"Yorishiro(Wooden Stab)", value:"horn-yorishiro"},

            { name:"1ND14N-5T4R(Bulkwark)", value:"back-1nd14n-5t4r"},
            { name:"Anemone(Aqua Vitality)", value:"back-anemone"},
            { name:"Balloon(Balloon Pop)", value:"back-balloon"},
            { name:"Bidens(Cleanse Scent)", value:"back-bidens"},
            { name:"Blue Moon(Scale Dart)", value:"back-blue-moon"},
            { name:"Bone Sail(lvory Chop)", value:"back-bone-sail"},
            { name:"Buzz Buzz(Bug Noise)", value:"back-buzz-buzz"},
            { name:"Candy Canes(Barb Strike)", value:"back-candy-canes"},
            { name:"Croc(Nile Strike)", value:"back-croc"},
            { name:"Crystal Hermit(Shelter)", value:"back-crystal-hermit"},
            { name:"Cupid(Heart Break)", value:"back-cupid"},
            { name:"Furball(Juggling Balls)", value:"back-furball"},
            { name:"Frozen Bucket(Bulkwark)", value:"back-frozen-bucket"},
            { name:"Garish Worm(Barb Strike)", value:"back-garish-worm"},
            { name:"Goldfish(Swift Escape)", value:"back-goldfish"},
            { name:"Green Thorns(Vine Dagger)", value:"back-green-thorns"},
            { name:"Hamaya(Revenge Arrow)", value:"back-hamaya"},
            { name:"Hasagi(Single Combat)", value:"back-hasagi"},
            { name:"Hermit(Shelter)", value:"back-hermit"},
            { name:"Hero(Heroic Reward)", value:"back-hero"},
            { name:"lndian Star(Bulkwark)", value:"back-indian-star"},
            { name:"Jaguar(Nitro Leap)", value:"back-jaguar"},
            { name:"Kingfisher(Patient Hunter)", value:"back-kingfisher"},
            { name:"Mint(Refresh)", value:"back-mint"},
            { name:"Origami(Heart Break)", value:"back-origami"},
            { name:"Perch(Spinal Tap)", value:"back-perch"},
            { name:"Pigeon Post(Blackmail)", value:"back-pigeon-post"},
            { name:"Pink Turnip(Turnip Rocket)", value:"back-pink-turnip"},
            { name:"Pumpkin(October Treat)", value:"back-pumpkin"},
            { name:"Raven(lll-omened)", value:"back-raven"},
            { name:"Red Ear(Slippery Shield)", value:"back-red-ear"},
            { name:"Risky Beast(Revenge Arrow)", value:"back-risky-beast"},
            { name:"Ronin(Single Combat)", value:"back-ronin"},
            { name:"Rugged Sail(lvory Chop)", value:"back-rugged-sail"},
            { name:"Sandal(Bug Splat)", value:"back-sandal"},
            { name:"Scarab(Scarab Curse)", value:"back-scarab"},
            { name:"Shiitake(Shroom's Grace)", value:"back-shiitake"},
            { name:"Snail Shell(Sticky Goo)", value:"back-snail-shell"},
            { name:"Spiky Wing(Buzzing Wind)", value:"back-spiky-wing"},
            { name:"Sponge(Shipwreck)", value:"back-sponge"},
            { name:"Starry Balloon(Balloon Pop)", value:"back-starry-balloon"},
            { name:"Starry Shell(Sticky Goo)", value:"back-starry-shell"},
            { name:"Timber(Woodman Power)", value:"back-timber"},
            { name:"Tri Feather(Triple Threat)", value:"back-tri-feather"},
            { name:"Tri Spikes(Spike Throw)", value:"back-tri-spikes"},
            { name:"Turnip(Turnip Rocket)", value:"back-turnip"},
            { name:"Watering Can(Aqua Stock)", value:"back-watering-can"},
            { name:"Yakitori(Shroom's Grace)", value:"back-yakitori"},

            { name:"Ant(Chemical Warfare)", value:"tail-ant"},
            { name:"Carrot(Carrot Hammer)", value:"tail-carrot"},
            { name:"Cattail(Cattail Slap)", value:"tail-cattail"},
            { name:"Cloud(Puffy Smack)", value:"tail-cloud"},
            { name:"Cottontail(Luna Absorb)", value:"tail-cottontail"},
            { name:"December Surprise(Jar Barrage)", value:"tail-december-surprise"},
            { name:"Escaped Gecko(Critical Escape)", value:"tail-escaped-gecko"},
            { name:"Feather Fan(Sunder Armor)", value:"tail-feather-fan"},
            { name:"Fir Trunk(Tiny Swing)", value:"tail-fir-trunk"},
            { name:"Fire Ant(Chemical Warfare)", value:"tail-fire-ant"},
            { name:"Fish Snack(Anesthetic Bait)", value:"tail-fish-snack"},
            { name:"Gerbil(Gerbil Jump)", value:"tail-gerbil"},
            { name:"Gila(Neuro Toxin)", value:"tail-gila"},
            { name:"Granma's Fan(Cool Breeze)", value:"tail-granmas-fan"},
            { name:"Grass Snake(Venom Spray)", value:"tail-grass-snake"},
            { name:"Gravel Ant(Numbing Lecretion)", value:"tail-gravel-ant"},
            { name:"Hare(Hare Dagger)", value:"tail-hare"},
            { name:"Hatsune(Leek Leak)", value:"tail-hatsune"},
            { name:"Hot Butt(Spicy Surprise)", value:"tail-hot-butt"},
            { name:"lguana(Scale Dart)", value:"tail-iguana"},
            { name:"Koi(Upstream Swim)", value:"tail-koi"},
            { name:"Koinobori(Upstream Swim)", value:"tail-koinobori"},
            { name:"Kuro Koi(Upstream Swim)", value:"tail-kuro-koi"},
            { name:"Maki(Anesthetic Bait)", value:"tail-maki"},
            { name:"Namek Carrot(Carrot Hammer)", value:"tail-namek-carrot"},
            { name:"Navaga(Flanking Smack)", value:"tail-navaga"},
            { name:"Nimo(Tail Slap)", value:"tail-nimo"},
            { name:"Nut Cracker(Nut Throw)", value:"tail-nut-cracker"},
            { name:"Omatsuri(Cool Breeze)", value:"tail-omatsuri"},
            { name:"Post Fight(All-out Shot)", value:"tail-post-fight"},
            { name:"Potato Leaf(Aqua Deflect)", value:"tail-potato-leaf"},
            { name:"Pupae(Grub Explode)", value:"tail-pupae"},
            { name:"Ranchu(Water Sphere)", value:"tail-ranchu"},
            { name:"Rice(Night Steal)", value:"tail-rice"},
            { name:"Sakura Cottontail(Luna Absorb)", value:"tail-sakura-cottontail"},
            { name:"Shiba(Rampant Howl)", value:"tail-shiba"},
            { name:"Shrimp(Chitin Jump)", value:"tail-shrimp"},
            { name:"Snake Jar(Jar Barrage)", value:"tail-snake-jar"},
            { name:"Snowy Swallow(Early Bird)", value:"tail-snowy-swallow"},
            { name:"Swallow(Early Bird)", value:"tail-swallow"},
            { name:"Tadpole(Black Bubble)", value:"tail-tadpole"},
            { name:"The Last One(Risky Feather)", value:"tail-the-last-one"},
            { name:"Thorny Caterpillar(Allergic Reaction)", value:"tail-thorny-caterpillar"},
            { name:"Tiny Dino(Tiny Swing)", value:"tail-tiny-dino"},
            { name:"Twin Tail(Twin Needle)", value:"tail-twin-tail"},
            { name:"Wall Gecko(Critical Escape)", value:"tail-wall-gecko"},
            { name:"Yam(Gas Unleash)", value:"tail-yam"},



        ]

        var demo2 = xmSelect.render({
            el: '#demo1',
            filterable: true,
            autoRow: true,
            theme: {
                color: '#6739b6',
            },
            filterMethod: function(val, item, index, prop){
                if(val == item.value){//把value相同的搜索出来
                    return true;
                }
                if(item.name.indexOf(val) != -1){//名称中包含的搜索出来
                    return true;
                }
                return false;//不知道的就不管了
            },
            data: [
                { name:"Blossom", value:"eyes-blossom"},
                { name:"Bookworm", value:"eyes-bookworm"},
                { name:"Broken Bookworm", value:"eyes-broken-bookworm"},
                { name:"Calico Zeal", value:"eyes-calico-zeal"},
                { name:"Chubby", value:"eyes-chubby"},
                { name:"Clear", value:"eyes-clear"},
                { name:"Confused", value:"eyes-confused"},
                { name:"Crimson Gecko", value:"eyes-crimson-gecko"},
                { name:"Cucumber Slice", value:"eyes-cucumber-slice"},
                { name:"Dokuganryu", value:"eyes-dokuganryu"},
                { name:"Dreamy Papi", value:"eyes-eyes-dreamy-papi"},
                { name:"Gecko", value:"eyes-gecko"},
                { name:"Gero", value:"eyes-gero"},
                { name:"lcy Gaze", value:"eyes-icy-gaze"},
                { name:"Insomnia", value:"eyes-insomnia"},
                { name:"Kabuki", value:"eyes-kabuki"},
                { name:"Kotaro", value:"eyes-kotaro"},
                { name:"Little Owl", value:"eyes-little-owl"},
                { name:"Little Peas", value:"eyes-little-peas"},
                { name:"Lucas", value:"eyes-lucas"},
                { name:"Mavis", value:"eyes-mavis"},
                { name:"Neo", value:"eyes-neo"},
                { name:"Nerdy", value:"eyes-nerdy"},
                { name:"Papi", value:"eyes-papi"},
                { name:"Puppy", value:"eyes-puppy"},
                { name:"Robin", value:"eyes-robin"},
                { name:"Scar", value:"eyes-scar"},
                { name:"Sky Mavis", value:"eyes-sky-mavis"},
                { name:"Sleepless", value:"eyes-sleepless"},
                { name:"Snowflakes", value:"eyes-snowflakes"},
                { name:"Telescope", value:"eyes-telescope"},
                { name:"Topaz", value:"eyes-topaz"},
                { name:"Tricky", value:"eyes-tricky"},
                { name:"Yen", value:"eyes-yen"},
                { name:"Zeal", value:"eyes-zeal"},

                { name:"Beetle Spike", value:"ears-beetle-spike"},
                { name:"Belieber", value:"ears-belieber"},
                { name:"Bubblemaker", value:"ears-bubblemaker"},
                { name:"Clover", value:"ears-clover"},
                { name:"Curly", value:"ears-curly"},
                { name:"Curved Spine", value:"ears-curved-spine"},
                { name:"Deadly Pogona", value:"ears-deadly-pogona"},
                { name:"Ear Breathing", value:"ears-ear-breathing"},
                { name:"Early Bird", value:"ears-early-bird"},
                { name:"Earwing", value:"ears-earwing"},
                { name:"Friezard", value:"ears-friezard"},
                { name:"Gill", value:"ears-gill"},
                { name:"Heart Cheek", value:"ears-heart-cheek"},
                { name:"Hollow", value:"ears-hollow"},
                { name:"Inkling", value:"ears-inkling"},
                { name:"Innocent Lamb", value:"ears-innocent-lamb"},
                { name:"Karimata", value:"ears-karimata"},
                { name:"Larva", value:"ears-larva"},
                { name:"Leaf Bug", value:"ears-leaf-bug"},
                { name:"Leafy", value:"ears-leafy"},
                { name:"Lotus", value:"ears-lotus"},
                { name:"Maiko", value:"ears-maiko"},
                { name:"Merry Lamb", value:"ears-merry-lamb"},
                { name:"Mon", value:"ears-mon"},
                { name:"Nimo", value:"ears-nimo"},
                { name:"Nut Cracker", value:"ears-nut-cracker"},
                { name:"Nyan", value:"ears-nyan"},
                { name:"Owl", value:"ears-owl"},
                { name:"Peace Maker", value:"ears-peace-maker"},
                { name:"Pinecones", value:"ears-pinecones"},
                { name:"Pink Cheek", value:"ears-pink-cheek"},
                { name:"Pogona", value:"ears-pogona"},
                { name:"Pointy Nyan", value:"ears-pointy-nyan"},
                { name:"Puppy", value:"ears-puppy"},
                { name:"Red Nimo", value:"ears-red-nimo"},
                { name:"Risky Bird", value:"ears-risky-bird"},
                { name:"Rosa", value:"ears-rosa"},
                { name:"Sakura", value:"ears-sakura"},
                { name:"Seaslug", value:"ears-seaslug"},
                { name:"Sidebarb", value:"ears-sidebarb"},
                { name:"Small Frill", value:"ears-small-frill"},
                { name:"Swirl", value:"ears-swirl"},
                { name:"Tassels", value:"ears-tassels"},
                { name:"The Last Leaf", value:"ears-the-last-leaf"},
                { name:"Tiny Fan", value:"ears-tiny-fan"},
                { name:"Vector", value:"ears-vector"},
                { name:"Zen", value:"ears-zen"},

                { name:"Axie Kiss(Death Mark)", value:"mouth-axie-kiss"},
                { name:"Catfish(Swallow)", value:"mouth-catfish"},
                { name:"Confident(Self Rally)", value:"mouth-confident"},
                { name:"Cute Bunny(Terror Chomp)", value:"mouth-cute-bunny"},
                { name:"Dango(Chomp)", value:"mouth-dango"},
                { name:"Doubletalk(Soothing Song)", value:"mouth-doubletalk"},
                { name:"Feasting Mosquito(Feasting MosquitoBlood Taste)", value:"mouth-feasting-mosquito"},
                { name:"Geisha(Crimson Water)", value:"mouth-geisha"},
                { name:"Goda(Piercing Sound)", value:"mouth-goda"},
                { name:"Herbivore(Vegan Diet)", value:"mouth-herbivore"},
                { name:"Humorless(HumorlessVegetal Bite)", value:"mouth-humorless"},
                { name:"Hungry Bird(lnsectivore)", value:"mouth-hungry-bird"},
                { name:"Kawaii(Terror Chomp)", value:"mouth-kawaii"},
                { name:"Kotaro(Kotaro bite)", value:"mouth-kotaro"},
                { name:"Lam(Angry Lam)", value:"mouth-lam"},
                { name:"Lam Handsome(Angry Lam)", value:"mouth-lam-handsome"},
                { name:"Little Owl(Dark Swoop)", value:"mouth-little-owl"},
                { name:"Mosquito(Blood Taste)", value:"mouth-mosquito"},
                { name:"Mr. Doubletalk(Soothing Song)", value:"mouth-mr-doubletalk"},
                { name:"Nut Cracker(Nut Crack)", value:"mouth-nut-cracker"},
                { name:"Peace Maker(Peace Treaty)", value:"mouth-peace-maker"},
                { name:"Pincer(Sunder Claw)", value:"mouth-pincer"},
                { name:"Piranha(Crimson Water)", value:"mouth-piranha"},
                { name:"Razor Bite(Why So Serious)", value:"mouth-razor-bite"},
                { name:"Risky Fish(Fish Hook)", value:"mouth-risky-fish"},
                { name:"Rudolph(Drain Bite)", value:"mouth-rudolph"},
                { name:"Serious(Vegetal Bite)", value:"mouth-serious"},
                { name:"Silence Whisper(Forest Spirit)", value:"mouth-silence-whisper"},
                { name:"Skull Cracker(Nut Crack)", value:"mouth-skull-cracker"},
                { name:"Square Teeth(Mite Bite)", value:"mouth-square-teeth"},
                { name:"Tiny Carrot(Chomp)", value:"mouth-tiny-carrot"},
                { name:"Tiny Turtle(Chomp)", value:"mouth-tiny-turtle"},
                { name:"Toothless Bite(Sneaky Raid)", value:"mouth-toothless-bite"},
                { name:"Venom Bite(Sneaky Raid)", value:"mouth-venom-bite"},
                { name:"Zigzag(Drain Bite)", value:"mouth-zigzag"},

                { name:"5H04L-5T4R(Star Shuriken)", value:"horn-5h04l-5t4r"},
                { name:"Anemone(Aquaponics)", value:"horn-anemone"},
                { name:"Antenna(Bug Signal)", value:"horn-antenna"},
                { name:"Arco(Acrobatic)", value:"horn-arco"},
                { name:"Babylonia(Shell Jab)", value:"horn-babylonia"},
                { name:"Bamboo Shoot(Bamboo Clan)", value:"horn-bamboo-shoot"},
                { name:"Beech(Wooden Stab)", value:"horn-beech"},
                { name:"Bumpy(Overgrow Keratin)", value:"horn-bumpy"},
                { name:"Cactus(Prickly Trap)", value:"horn-cactus"},
                { name:"Candy Babylonia(Shell Jab)", value:"horn-candy-babylonia"},
                { name:"Caterpillars(Grub Surprise)", value:"horn-caterpillars"},
                { name:"Cerastes(Surprise Invasion)", value:"horn-cerastes"},
                { name:"Clamshell(Clam Slash)", value:"horn-clamshell"},
                { name:"Cuckoo(Cockadoodledoo)", value:"horn-cuckoo"},
                { name:"Dual Blade(Sinister Strike)", value:"horn-dual-blade"},
                { name:"Eggshell(Eggbomb)", value:"horn-eggshell"},
                { name:"Feather Spear(Feather Lunge)", value:"horn-feather-spear"},
                { name:"Golden Bamboo Shoot(Bamboo Clan)", value:"horn-golden-bamboo-shoot"},
                { name:"Golden Shell(Eggbomb)", value:"horn-golden-shell"},
                { name:"Imp(lvory Stab)", value:"horn-imp"},
                { name:"Incisor(Disarm)", value:"horn-incisor"}, //这个好像忘记了
                { name:"Kendama(lvory Stab)", value:"horn-kendama"},
                { name:"Kestrel(Headshot)", value:"horn-kestrel"},
                { name:"Lagging(Mystic Rush)", value:"horn-lagging"},
                { name:"Laggingggggg(Mystic Rush)", value:"horn-laggingggggg"},
                { name:"Leaf Bug(Disguise)", value:"horn-leaf-bug"},
                { name:"Little Branch(Branch Charge)", value:"horn-little-branch"},
                { name:"Merry(Merry Legion)", value:"horn-merry"},
                { name:"Oranda(Hero's Bane)", value:"horn-oranda"},
                { name:"P4R451T3(Third Glance)", value:"horn-p4r451t3"},
                { name:"Parasite(Third Glance)", value:"horn-parasite"},
                { name:"Pinku Unko(Poo Fling)", value:"horn-pinku-unko"},
                { name:"Pliers(Dull Grip)", value:"horn-pliers"},
                { name:"Pocky(Sugar Rush)", value:"horn-pocky"},
                { name:"Rose Bud(Healing Aroma)", value:"horn-rose-bud"},
                { name:"Santas Gift(Prickly Trap)", value:"horn-santas-gift"},
                { name:"Scaly Spear(Scaly Lunge)", value:"horn-scaly-spear"},
                { name:"Scaly Spoon(Tiny Catapult)", value:"horn-scaly-spoon"},
                { name:"Shoal Star(Star Shuriken)", value:"horn-shoal-star"},
                { name:"Spruce Spear(Feather Lunge)", value:"horn-spruce-spear"},
                { name:"Strawberry Shortcake(Sweet Party)", value:"horn-strawberry-shortcake"},
                { name:"Teal Shell(Deep Sea Gore)", value:"horn-teal-shell"},
                { name:"Trump(Air Force One)", value:"horn-trump"},
                { name:"Umaibo(Sugar Rush)", value:"horn-umaibo"},
                { name:"Unko(Poo Fling)", value:"horn-unko"},
                { name:"Watermelon(Seed Bullet)", value:"horn-watermelon"},
                { name:"Wing Horn(Smart Shot)", value:"horn-wing-horn"},
                { name:"Winter Branch(Branch Charge)", value:"horn-winter-branch"},
                { name:"Yorishiro(Wooden Stab)", value:"horn-yorishiro"},

                { name:"1ND14N-5T4R(Bulkwark)", value:"back-1nd14n-5t4r"},
                { name:"Anemone(Aqua Vitality)", value:"back-anemone"},
                { name:"Balloon(Balloon Pop)", value:"back-balloon"},
                { name:"Bidens(Cleanse Scent)", value:"back-bidens"},
                { name:"Blue Moon(Scale Dart)", value:"back-blue-moon"},
                { name:"Bone Sail(lvory Chop)", value:"back-bone-sail"},
                { name:"Buzz Buzz(Bug Noise)", value:"back-buzz-buzz"},
                { name:"Candy Canes(Barb Strike)", value:"back-candy-canes"},
                { name:"Croc(Nile Strike)", value:"back-croc"},
                { name:"Crystal Hermit(Shelter)", value:"back-crystal-hermit"},
                { name:"Cupid(Heart Break)", value:"back-cupid"},
                { name:"Furball(Juggling Balls)", value:"back-furball"},
                { name:"Frozen Bucket(Bulkwark)", value:"back-frozen-bucket"},
                { name:"Garish Worm(Barb Strike)", value:"back-garish-worm"},
                { name:"Goldfish(Swift Escape)", value:"back-goldfish"},
                { name:"Green Thorns(Vine Dagger)", value:"back-green-thorns"},
                { name:"Hamaya(Revenge Arrow)", value:"back-hamaya"},
                { name:"Hasagi(Single Combat)", value:"back-hasagi"},
                { name:"Hermit(Shelter)", value:"back-hermit"},
                { name:"Hero(Heroic Reward)", value:"back-hero"},
                { name:"lndian Star(Bulkwark)", value:"back-indian-star"},
                { name:"Jaguar(Nitro Leap)", value:"back-jaguar"},
                { name:"Kingfisher(Patient Hunter)", value:"back-kingfisher"},
                { name:"Mint(Refresh)", value:"back-mint"},
                { name:"Origami(Heart Break)", value:"back-origami"},
                { name:"Perch(Spinal Tap)", value:"back-perch"},
                { name:"Pigeon Post(Blackmail)", value:"back-pigeon-post"},
                { name:"Pink Turnip(Turnip Rocket)", value:"back-pink-turnip"},
                { name:"Pumpkin(October Treat)", value:"back-pumpkin"},
                { name:"Raven(lll-omened)", value:"back-raven"},
                { name:"Red Ear(Slippery Shield)", value:"back-red-ear"},
                { name:"Risky Beast(Revenge Arrow)", value:"back-risky-beast"},
                { name:"Ronin(Single Combat)", value:"back-ronin"},
                { name:"Rugged Sail(lvory Chop)", value:"back-rugged-sail"},
                { name:"Sandal(Bug Splat)", value:"back-sandal"},
                { name:"Scarab(Scarab Curse)", value:"back-scarab"},
                { name:"Shiitake(Shroom's Grace)", value:"back-shiitake"},
                { name:"Snail Shell(Sticky Goo)", value:"back-snail-shell"},
                { name:"Spiky Wing(Buzzing Wind)", value:"back-spiky-wing"},
                { name:"Sponge(Shipwreck)", value:"back-sponge"},
                { name:"Starry Balloon(Balloon Pop)", value:"back-starry-balloon"},
                { name:"Starry Shell(Sticky Goo)", value:"back-starry-shell"},
                { name:"Timber(Woodman Power)", value:"back-timber"},
                { name:"Tri Feather(Triple Threat)", value:"back-tri-feather"},
                { name:"Tri Spikes(Spike Throw)", value:"back-tri-spikes"},
                { name:"Turnip(Turnip Rocket)", value:"back-turnip"},
                { name:"Watering Can(Aqua Stock)", value:"back-watering-can"},
                { name:"Yakitori(Shroom's Grace)", value:"back-yakitori"},

                { name:"Ant(Chemical Warfare)", value:"tail-ant"},
                { name:"Carrot(Carrot Hammer)", value:"tail-carrot"},
                { name:"Cattail(Cattail Slap)", value:"tail-cattail"},
                { name:"Cloud(Puffy Smack)", value:"tail-cloud"},
                { name:"Cottontail(Luna Absorb)", value:"tail-cottontail"},
                { name:"December Surprise(Jar Barrage)", value:"tail-december-surprise"},
                { name:"Escaped Gecko(Critical Escape)", value:"tail-escaped-gecko"},
                { name:"Feather Fan(Sunder Armor)", value:"tail-feather-fan"},
                { name:"Fir Trunk(Tiny Swing)", value:"tail-fir-trunk"},
                { name:"Fire Ant(Chemical Warfare)", value:"tail-fire-ant"},
                { name:"Fish Snack(Anesthetic Bait)", value:"tail-fish-snack"},
                { name:"Gerbil(Gerbil Jump)", value:"tail-gerbil"},
                { name:"Gila(Neuro Toxin)", value:"tail-gila"},
                { name:"Granma's Fan(Cool Breeze)", value:"tail-granmas-fan"},
                { name:"Grass Snake(Venom Spray)", value:"tail-grass-snake"},
                { name:"Gravel Ant(Numbing Lecretion)", value:"tail-gravel-ant"},
                { name:"Hare(Hare Dagger)", value:"tail-hare"},
                { name:"Hatsune(Leek Leak)", value:"tail-hatsune"},
                { name:"Hot Butt(Spicy Surprise)", value:"tail-hot-butt"},
                { name:"lguana(Scale Dart)", value:"tail-iguana"},
                { name:"Koi(Upstream Swim)", value:"tail-koi"},
                { name:"Koinobori(Upstream Swim)", value:"tail-koinobori"},
                { name:"Kuro Koi(Upstream Swim)", value:"tail-kuro-koi"},
                { name:"Maki(Anesthetic Bait)", value:"tail-maki"},
                { name:"Namek Carrot(Carrot Hammer)", value:"tail-namek-carrot"},
                { name:"Navaga(Flanking Smack)", value:"tail-navaga"},
                { name:"Nimo(Tail Slap)", value:"tail-nimo"},
                { name:"Nut Cracker(Nut Throw)", value:"tail-nut-cracker"},
                { name:"Omatsuri(Cool Breeze)", value:"tail-omatsuri"},
                { name:"Post Fight(All-out Shot)", value:"tail-post-fight"},
                { name:"Potato Leaf(Aqua Deflect)", value:"tail-potato-leaf"},
                { name:"Pupae(Grub Explode)", value:"tail-pupae"},
                { name:"Ranchu(Water Sphere)", value:"tail-ranchu"},
                { name:"Rice(Night Steal)", value:"tail-rice"},
                { name:"Sakura Cottontail(Luna Absorb)", value:"tail-sakura-cottontail"},
                { name:"Shiba(Rampant Howl)", value:"tail-shiba"},
                { name:"Shrimp(Chitin Jump)", value:"tail-shrimp"},
                { name:"Snake Jar(Jar Barrage)", value:"tail-snake-jar"},
                { name:"Snowy Swallow(Early Bird)", value:"tail-snowy-swallow"},
                { name:"Swallow(Early Bird)", value:"tail-swallow"},
                { name:"Tadpole(Black Bubble)", value:"tail-tadpole"},
                { name:"The Last One(Risky Feather)", value:"tail-the-last-one"},
                { name:"Thorny Caterpillar(Allergic Reaction)", value:"tail-thorny-caterpillar"},
                { name:"Tiny Dino(Tiny Swing)", value:"tail-tiny-dino"},
                { name:"Twin Tail(Twin Needle)", value:"tail-twin-tail"},
                { name:"Wall Gecko(Critical Escape)", value:"tail-wall-gecko"},
                { name:"Yam(Gas Unleash)", value:"tail-yam"},



            ]
        })

        //获取模板列表添加到下拉框中
        $.ajax({
            url: requertUrl+"/getWcModel",
            dataType: 'json',
            type: 'GET',
            success: function (dataArray) {

                // console.log(dataArray)
                if (dataArray.code != 200) {

                    // console.log(dataArray.msg)
                    // layer.msg(dataArray.msg);

                    return false;

                }

                allJsonOBJ = dataArray.msg
                // console.log(allJsonOBJ)
                var returnDataArray = dataArray.msg
                // currSelectReturnDataArray= returnDataArray
                // var currAccountID = returnDataArray[0].id
                // var currAccountTokenValue = returnDataArray[0]['token_value']
                // currSelectReturnID = currAccountID
                // currSelectReturnTokenValue= currAccountTokenValue
                // console.log("returnDataArray",returnDataArray)

                $("#templateList").empty();
                $('#templateList').append(new Option("请选择模板","9999999"));
                $.each(returnDataArray, function (index, item) {
                    $('#templateList').append(new Option(item.remark, item.remark));// 下拉菜单里添加元素

                });

                // $("#templateList").attr("selected", "selected");

                //重新渲染 固定写法
                form.render("select");






            }
        })

        //订单表
        var tableIns = table.render({
        elem: '#test',
        // url : 'aaa.json',
        data:[],
        // url : requertUrl+"/setInformation",
        // method: 'post',
        // where:{token: $.cookie('tokenMyb'),status:1,addFans_status:2,add_group_status:1},//1是:当前访问的是审核通过的数据
        cellMinWidth : 95,
        // page :  { //支持传入 laypage 组件的所有参数（某些参数除外，如：jump/elem） - 详见文档
        //   layout: ['limit', 'count', 'prev', 'page', 'next', 'skip'] //自定义分页布局
        //   //,curr: 5 //设定初始在第 5 页
        //   ,groups: 10 //只显示 1 个连续页码
        //   ,first: "首页" //不显示首页
        //   ,last: "尾页"//不显示尾页
        //
        // },
        height : "full-20",
        // limit : 15,
        // limits : [15,30,50,100],
        id : "systemLog",
        // loading:false,
        response: {
          statusName: 'code' //规定数据状态的字段名称，默认：code
          ,statusCode: "200", //规定成功的状态码，默认：0
          // ,msgName: 'hint' //规定状态信息的字段名称，默认：msg
          // ,countName: 'total', //规定数据总数的字段名称，默认：count
          dataName: 'result' //规定数据列表的字段名称，默认：data
        },
        parseData: function(res){ //res 即为原始返回的数据

          // console.log(res)
          return {
            "code":200,
            // "result": res.result.data.axies.results //解析数据列表
            "result": res.result.data.axies.results //解析数据列表

          };
        },
        cols : [[
          {type: "checkbox", fixed:"left"},
          // {field: 'id', title: '编号', width:60, align:"center"},
          // {field: 'xid', title: '编号', width:60, align:"center",templet: '#titleTpl'},
          {field: 'id', title: 'ID', sort: true,minWidth:'100',align:"center"}, //, style :'display: none'
          {field: 'image', title: '宠物图像',sort: true,width:122, height:200, align:'center',templet: function(d){

              var imageName = d.image;

              return '<div ><img src="'+imageName+'" ' + 'alt="" width="200px" height="60px"></a></div>';

          }},
          {field: 'class', title: '种类', sort: true, align:'center',width:120,templet: function (d) {
              // console.log(d)
              return d.class
          }},
          {field: 'Eyes', title: '眼(eyes)', sort: true, align:'center',width:150, templet: function (d) {

              let currData = d.parts[0]
              // console.log(currData,typeof currData)
              if(!currData ){
                return "无"
              }else{
                return d.parts[0].name
              }

          }},
          {field: 'Ears', title: '耳(ears)', sort: true, align:'center', templet: function (d) {

              let currData = d.parts[1]
              // console.log(currData,typeof currData)
              if(!currData ){
                return "无"
              }else{
                return d.parts[1].name
              }

          }},
          {field: 'Back', title: '背(back)', sort: true, align:'center', templet: function (d) {

              let currData = d.parts[1]
              // console.log(currData,typeof currData)
              if(!currData ){
                return "无"
              }else{
                return d.parts[2].name
              }

            }},
          {field: 'Mouth', title: '牙(mouth)', sort: true, align:'center', templet: function (d) {

              let currData = d.parts[1]
              // console.log(currData,typeof currData)
              if(!currData ){
                return "无"
              }else{
                return d.parts[3].name
              }

          }},
          {field: 'Horn', title: '角(horn)', sort: true, align:'center', templet: function (d) {

              let currData = d.parts[1]
              // console.log(currData,typeof currData)
              if(!currData ){
                return "无"
              }else{
                return d.parts[4].name
              }

          }},
          {field: 'Tail', title: '尾(tail)', sort: true, align:'center', templet: function (d) {

              let currData = d.parts[1]
              // console.log(currData,typeof currData)
              if(!currData ){
                return "无"
              }else{
                return d.parts[5].name
              }

          }},
          {field: 'content', title: '价格(USD)', sort: true,align:'center', templet: function (d) {


              // console.log(d.auction.currentPriceUSD)

              return d.auction.currentPriceUSD

          }},
          {field: 'content', title: '价格(ETH)', sort: true,align:'center', templet: function (d) {


                // console.log(d.auction.currentPriceUSD)


                  // var input_curr_eth_price = parseFloat(d.auction.currentPriceUSD)
                  // var input_curr_fl_price = parseFloat('3784')
                  //
                  // //美元价格
                  // var  input_curr_usd_price = parseFloat(input_curr_eth_price /  input_curr_fl_price) // 输出结果为 2.4544


                return parseInt(d.auction.currentPrice)/1000000000000000000
          }},
          // {field: 'created_at', title: '创建时间',sort: true, width: 190, align:'center',templet: function (d) {
          //     var unixTimestamp = new Date(d.created_at * 1000)
          //     return formatDateTime(unixTimestamp)
          // }},
          // {field: 'updated_at', title: '更新时间',sort: true,width:190, align:'center',templet: function (d) {
          //     var unixTimestamp = new Date(d.updated_at * 1000)
          //     return formatDateTime(unixTimestamp)
          // }},

          // {field: 'order_time',title: '订单时间', width:163,align:"center"},
          // {field: 'order_time',title: '订单时间', width:118,align:"center",templet:function(d){
          //         var to = d.order_time.substr(5,);
          //         return to
          //     }},
          // {title: '', width:1, templet:'#orderListBar',fixed:"right",align:"center"}
        ]],
        done: function(res, curr, count){
          // console.log("res",res.result.data.axies.results)
          // res = res.result.data.axies.results
        }
      });

        //添加模板入库
        $("#addTempDb").click(function () {


            var data = form.val('classform');

            // console.log(data)


            var classStrS =""

            if(data.Beast == "on"){
                // console.log("进来")
                classStrS = "Beast"
            }

            if(data.Aquatic == "on"){
                classStrS =  "Aquatic"
            }

            if(data.Plant == "on"){
                classStrS =  "Plant"
            }

            if(data.Bird == "on"){
                classStrS =  "Bird"
            }

            if(data.Bug == "on"){
                classStrS =  "Bug"
            }

            if(data.Reptile == "on"){
                classStrS =  "Reptile"
            }

            if(data.Mech == "on"){
                classStrS = "Mech"
            }

            if(data.Dawn == "on"){
                classStrS =  "Dawn"
            }

            if(data.Dusk == "on"){
                classStrS =  "Dusk"
            }

            if(classStrS == ""){

                // layer.msg("请先选择宠物种类！")

                classStrS = 1
            }


            var selectArr = demo2.getValue("name");
            var selectArrValue = demo2.getValue("value");

            // console.log(selectArr,selectArrValue)

            // console.log("selectArrValue",selectArr)


            var combeArray = []
            for(var i=0;i<selectArr.length;i++){
                combeArray.push({
                    nameLabel:selectArr[i],
                    keyValue:selectArrValue[i],
                })
            }
            // console.log("combeArray",combeArray)
            var combeJson = {eyes:'',ears:'',back:'',mouth:'',horn:'',tail:'',}


            combeArray.find((item,index)=>{


                // console.log("查询的值",item.keyValue)
                // console.log("对应的值",selectArrValue[index])

                if(item.keyValue == selectArrValue[index] && item.keyValue.indexOf('eyes-') != -1){

                    eyeIDStrS = item.nameLabel
                    // console.log("eyeIDStrS",eyeIDStrS,index)

                    combeJson.eyes = eyeIDStrS


                }else if(item.keyValue == selectArrValue[index] && item.keyValue.indexOf('ears-') != -1){

                    earIDStrS = item.nameLabel
                    // console.log("earIDStrS",earIDStrS,index)
                    combeJson.ears = earIDStrS



                }else if(item.keyValue == selectArrValue[index] && item.keyValue.indexOf('back-') != -1){

                    backIDStrS = item.nameLabel.split("(")[0]
                    // backIDStrS = item.nameLabel.substring(item.nameLabel.indexOf("(") + 1,item.nameLabel.indexOf(")"))
                    // console.log("backIDStrS",backIDStrS,index)
                    combeJson.back = backIDStrS


                }else if(item.keyValue == selectArrValue[index] && item.keyValue.indexOf('mouth-') != -1){
                    mouthIDStrS = item.nameLabel.split("(")[0]
                    // mouthIDStrS = item.nameLabel.substring(item.nameLabel.indexOf("(") + 1,item.nameLabel.indexOf(")"))
                    // console.log("mouthIDStrS",mouthIDStrS,index)
                    combeJson.mouth = mouthIDStrS


                }else if(item.keyValue == selectArrValue[index] && item.keyValue.indexOf('horn-') != -1){
                    hornIDStrS = item.nameLabel.split("(")[0]
                    // hornIDStrS = item.nameLabel.substring(item.nameLabel.indexOf("(") + 1,item.nameLabel.indexOf(")"))
                    // console.log("hornIDStrS",hornIDStrS,index)
                    combeJson.horn= hornIDStrS


                }else if(item.keyValue == selectArrValue[index] && item.keyValue.indexOf('tail-') != -1){

                    // console.log("没进来?",index)
                    tailIDStrS = item.nameLabel.split("(")[0]
                    // tailIDStrS = item.nameLabel.substring(item.nameLabel.indexOf("(") + 1,item.nameLabel.indexOf(")"))
                    // console.log("tailIDStrS",tailIDStrS)
                    combeJson.tail = tailIDStrS

                }else{

                }

            })

            var currAbilityStr = ""

            // combeJson.hasOwnProperty('')

            if(combeJson.eyes != ""){
                currAbilityStr = currAbilityStr +  "eyes-"+eyeIDStrS +"@"
            }

            if(combeJson.ears != ""){
                currAbilityStr = currAbilityStr +  "ears-"+earIDStrS +"@"
            }

            if(combeJson.back != ""){
                currAbilityStr = currAbilityStr +  "back-"+backIDStrS +"@"
            }

            if(combeJson.mouth != ""){
                currAbilityStr = currAbilityStr +  "mouth-"+mouthIDStrS +"@"
            }

            if(combeJson.horn != ""){
                currAbilityStr = currAbilityStr +  "horn-"+hornIDStrS +"@"
            }

            if(combeJson.tail != ""){
                currAbilityStr = currAbilityStr +  "tail-"+tailIDStrS
            }



            // console.log(combeJson)

            //
            // // console.log(eyeIDStrS,earIDStrS,backIDStrS,mouthIDStrS,hornIDStrS,tailIDStrS)
            //
            // var currAbilityStr = "eyes-"+eyeIDStrS +"@"+"ears-"+earIDStrS +"@"+"back-"+backIDStrS +"@"+"mouth-"+mouthIDStrS +"@"+"horn-"+hornIDStrS +"@"+"tail-"+tailIDStrS
            //
            //

            queryParamObj = {class:classStrS,ability:currAbilityStr}
            var jsondata = JSON.stringify(queryParamObj)
            // console.log(queryParamObj)


            var currQuerySqlID = currParentDatas.id
            // console.log("currQuerySqlID",currQuerySqlID)


            var index = layer.open({
                area: ['600px', '400px'],
                fixed: false, //不固定
                maxmin: false,
                title : "添加新模板",
                skin: 'layui-layer-rim',//加上边框
                type : 2,
                content : "capture_template_new_copy.html",
                success : function(layero, index){


                    var body = layer.getChildFrame('body', index);
                    //不显示出来的回显数据
                    body.find("#datastr").val(jsondata);
                    body.find("#sqlID").val(currQuerySqlID);
                    body.find("#modelID").val(totalNumValue);

                },
                end : function() {//弹窗关闭后的回调函数

                    //重新渲染 固定写法
                    form.render("select");

                }
            })
            window.sessionStorage.setItem("index",index);
            //改变窗口大小时，重置弹窗的宽高，防止超出可视区域（如F12调出debug的操作）
            $(window).on("resize",function(){
                layui.layer.full(window.sessionStorage.getItem("index"));
            })


            return false

        })


        //修改模板
        $("#editTempDb").click(function () {

            jsondata_template = JSON.stringify(currDatas_template)
            var index = layer.open({
                area: ['600px', '700px'],
                fixed: false, //不固定
                maxmin: false,
                title : "修改模板",
                skin: 'layui-layer-rim',//加上边框
                type : 2,
                content : "template_edit.html",
                success : function(layero, index){

                    var body = layer.getChildFrame('body', index);
                    //不显示出来的回显数据
                    // body.find("#datastr").val(jsondata);

                },
                end : function() {//弹窗关闭后的回调函数

                    //获取模板列表添加到下拉框中
                    $.ajax({
                        url: requertUrl+"/getWcModel",
                        dataType: 'json',
                        type: 'GET',
                        success: function (dataArray) {

                            // console.log(dataArray)
                            if (dataArray.code != 200) {

                                // console.log(dataArray.msg)
                                // layer.msg(dataArray.msg);

                                return false;

                            }

                            allJsonOBJ = dataArray.msg
                            // console.log(allJsonOBJ)
                            var returnDataArray = dataArray.msg
                            // currSelectReturnDataArray= returnDataArray
                            // var currAccountID = returnDataArray[0].id
                            // var currAccountTokenValue = returnDataArray[0]['token_value']
                            // currSelectReturnID = currAccountID
                            // currSelectReturnTokenValue= currAccountTokenValue
                            // console.log("returnDataArray",returnDataArray)

                            $("#templateList").empty();
                            $('#templateList').append(new Option("请选择模板","9999999"));
                            $.each(returnDataArray, function (index, item) {
                                $('#templateList').append(new Option(item.remark, item.remark));// 下拉菜单里添加元素

                            });

                            // $("#templateList").attr("selected", "selected");

                            //重新渲染 固定写法
                            form.render("select");



                        }
                    })


                }
            })
            window.sessionStorage.setItem("index",index);
            //改变窗口大小时，重置弹窗的宽高，防止超出可视区域（如F12调出debug的操作）
            $(window).on("resize",function(){
                layui.layer.full(window.sessionStorage.getItem("index"));
            })



            // layer.prompt({title: '请填写欲入库的名称?', formType:2}, function(text, index){
            //
            //     if(text == "" || text.length === 0){
            //
            //         layer.msg("入库名称不允许为空！", {icon: 2});
            //
            //         return false
            //     }
            //
            //     $.ajax({
            //         url: requertUrl+"/setWcModel?remark="+text+"&class="+classStrS+"&ability="+currAbilityStr,
            //         type: "GET",
            //         dataType:"json",
            //         success: function (resultJson) {
            //
            //             if(resultJson.code == -101){
            //
            //
            //                 layer.msg(resultJson.msg, {icon: 3});
            //                 return false
            //             }
            //
            //
            //             layer.msg(resultJson.msg, {icon: 1});
            //
            //             layer.close(index);
            //
            //
            //             //获取模板列表添加到下拉框中
            //             $.ajax({
            //                 url: requertUrl+"/getWcModel",
            //                 dataType: 'json',
            //                 type: 'GET',
            //                 success: function (dataArray) {
            //
            //                     // console.log(dataArray)
            //                     if (dataArray.code != 200) {
            //
            //                         // console.log(dataArray.msg)
            //                         // layer.msg(dataArray.msg);
            //
            //                         return false;
            //
            //                     }
            //
            //                     allJsonOBJ = dataArray.msg
            //                     // console.log(allJsonOBJ)
            //                     var returnDataArray = dataArray.msg
            //                     // currSelectReturnDataArray= returnDataArray
            //                     // var currAccountID = returnDataArray[0].id
            //                     // var currAccountTokenValue = returnDataArray[0]['token_value']
            //                     // currSelectReturnID = currAccountID
            //                     // currSelectReturnTokenValue= currAccountTokenValue
            //                     // console.log("returnDataArray",returnDataArray)
            //
            //                     $("#templateList").empty();
            //                     $('#templateList').append(new Option("请选择模板","9999999"));
            //                     $.each(returnDataArray, function (index, item) {
            //                         $('#templateList').append(new Option(item.remark, item.remark));// 下拉菜单里添加元素
            //
            //                     });
            //
            //                     // $("#templateList").attr("selected", "selected");
            //
            //                     //重新渲染 固定写法
            //                     form.render("select");
            //
            //
            //
            //
            //
            //
            //                 }
            //             })
            //
            //         },
            //
            //
            //     });
            //
            // });




            return false

        })


        /* 下拉框选中事件 */
        form.on('select(templateList)', function (dataSelect) {

            // console.log("选择ID",dataSelect)

             currQueryID = dataSelect.value

            if(currQueryID == "9999999"){
                //
                // $("#Beast").prop("checked", false);
                //
                // $("#Aquatic").prop("checked", false);
                // $("#Plant").prop("checked", false);
                // $("#Bird").prop("checked", false);
                // $("#Bug").prop("checked", false);
                // $("#Reptile").prop("checked", false);
                // $("#Mech").prop("checked", false);
                // $("#Dawn").prop("checked", false);
                // $("#Dusk").prop("checked", false);
                // form.render('checkbox')
                // demo2.setValue([])

                $("#templateContext").val("")

                return false
            }

            var queryResult = allJsonOBJ.filter((item)=>{

                // if(item.id == currQueryID ){
                //     return item
                // }

                if(item.remark == currQueryID ){
                    return item
                }

            })

            // console.log("当前ID对应的数据json",queryResult[0])
            currDatas_template =  queryResult[0]
            var classStr = queryResult[0].kinds


            var filecontent = "# 以下信息为模板的信息" + "\n"

            if(classStr == "1"){

                filecontent = filecontent + "类别 = " + "不限" + "\n"
            }else{
                filecontent = filecontent + "类别 = " + classStr + "\n"
            }

            if(queryResult[0].eyes == "1"){
                filecontent = filecontent + "眼睛 = " + "不限" + "\n"
            }else{
                filecontent = filecontent + "眼睛 = " + queryResult[0].eyes+ "\n"
            }

            if(queryResult[0].ears == "1"){
                filecontent = filecontent + "耳朵 = " + "不限" + "\n"
            }else{
                filecontent = filecontent + "耳朵 = " + queryResult[0].ears + "\n"
            }


            if(queryResult[0].back == "1"){
                filecontent = filecontent + "背 = " + "不限" + "\n"
            }else{
                filecontent = filecontent + "背 = " + queryResult[0].back + "\n"
            }


            if(queryResult[0].mouth == "1"){
                filecontent = filecontent + "牙 = " + "不限"+ "\n"
            }else{
                filecontent = filecontent + "牙 = " + queryResult[0].mouth+ "\n"
            }


            if(queryResult[0].horn == "1"){
                filecontent = filecontent + "角 = " + "不限"+ "\n"
            }else{
                filecontent = filecontent + "角 = " + queryResult[0].horn+ "\n"
            }


            if(queryResult[0].tail == "1"){
                filecontent = filecontent + "尾 = " + "不限"+ "\n"
            }else{
                filecontent = filecontent + "尾 = " + queryResult[0].tail+ "\n"
            }
            filecontent = filecontent + "价格(ETH) = " + queryResult[0].eth_price+ "\n"
            filecontent = filecontent + "价格(USD) = " + queryResult[0].price+ "\n"


            // filecontent = filecontent + "耳朵 = " + queryResult[0].ears.split("-")[1] + "\n"
            // filecontent = filecontent + "背 = " + queryResult[0].back.split("-")[1] + "\n"
            // filecontent = filecontent + "牙 = " + queryResult[0].mouth.split("-")[1]+ "\n"
            // filecontent = filecontent + "角 = " + queryResult[0].horn.split("-")[1]+ "\n"
            // filecontent = filecontent + "尾 = " + queryResult[0].tail.split("-")[1]


            $("#templateContext").val(filecontent)



            form.render('checkbox')

        })

        //重载窗口所有数据
        $("#reloadWindowBtn").click(function () {

            var indexLoad = layer.load(1, {
                shade: [0.1,'#fff'] //0.1透明度的白色背景
            });

            //页面进来就读取数据
            $.ajax({
                url: requertUrl+"/getOneInformation?axieId="+currQueryAxiesID,
                type: "GET",
                dataType:"json",
                timeout : 5000, //超时时间设置，单位毫秒

                success: function (resultJson) {

                    console.log('success-resultJson',resultJson)
                    if(!resultJson.hasOwnProperty("data") && resultJson.hasOwnProperty("errors")){

                        layer.close(indexLoad)
                        layer.msg('查询异常,存在errors,请重新查询！', {icon: 2});
                        return false

                    }


                    let axie =  resultJson.data.axie

                    if(axie == "undefined" || axie === null ){

                        // console.log("aaaaaa,没有值")
                        layer.closeAll()
                        // layer.msg("没有取到值,请确认宠物ID是否正确")
                        layer.msg('没有取到值,请确认宠物ID是否正确或502: Bad Gateway！', {icon: 2});
                        return false
                    }

                    let classStr =  resultJson.data.axie.class
                    let partArrS =  resultJson.data.axie.parts


                    if(classStr == "Beast"){
                        $("#Beast").prop("checked", true);

                        $("#Aquatic").prop("checked", false);
                        $("#Plant").prop("checked", false);
                        $("#Bird").prop("checked", false);
                        $("#Bug").prop("checked", false);
                        $("#Reptile").prop("checked", false);
                        $("#Mech").prop("checked", false);
                        $("#Dawn").prop("checked", false);
                        $("#Dusk").prop("checked", false);
                    }

                    if(classStr == "Aquatic"){
                        $("#Aquatic").prop("checked", true);

                        $("#Beast").prop("checked", false);
                        $("#Plant").prop("checked", false);
                        $("#Bird").prop("checked", false);
                        $("#Bug").prop("checked", false);
                        $("#Reptile").prop("checked", false);
                        $("#Mech").prop("checked", false);
                        $("#Dawn").prop("checked", false);
                        $("#Dusk").prop("checked", false);
                    }

                    if(classStr == "Plant"){
                        $("#Plant").prop("checked", true);
                        // $("#Plant").prop("checked", true);

                        $("#Beast").prop("checked", false);
                        $("#Aquatic").prop("checked", false);
                        $("#Bird").prop("checked", false);
                        $("#Bug").prop("checked", false);
                        $("#Reptile").prop("checked", false);
                        $("#Mech").prop("checked", false);
                        $("#Dawn").prop("checked", false);
                        $("#Dusk").prop("checked", false);

                    }

                    if(classStr == "Bird"){
                        $("#Bird").prop("checked", true);

                        $("#Beast").prop("checked", false);
                        $("#Aquatic").prop("checked", false);
                        $("#Plant").prop("checked", false);
                        $("#Bug").prop("checked", false);
                        $("#Reptile").prop("checked", false);
                        $("#Mech").prop("checked", false);
                        $("#Dawn").prop("checked", false);
                        $("#Dusk").prop("checked", false);
                    }

                    if(classStr == "Bug"){
                        $("#Bug").prop("checked", true);


                        $("#Beast").prop("checked", false);
                        $("#Aquatic").prop("checked", false);
                        $("#Plant").prop("checked", false);
                        $("#Bird").prop("checked", false);
                        $("#Reptile").prop("checked", false);
                        $("#Mech").prop("checked", false);
                        $("#Dawn").prop("checked", false);
                        $("#Dusk").prop("checked", false);


                    }

                    if(classStr == "Reptile"){
                        $("#Reptile").prop("checked", true);

                        $("#Beast").prop("checked", false);
                        $("#Aquatic").prop("checked", false);
                        $("#Plant").prop("checked", false);
                        $("#Bird").prop("checked", false);
                        $("#Bug").prop("checked", false);
                        $("#Mech").prop("checked", false);
                        $("#Dawn").prop("checked", false);
                        $("#Dusk").prop("checked", false);


                    }

                    if(classStr == "Mech"){
                        $("#Mech").prop("checked", true);

                        $("#Beast").prop("checked", false);
                        $("#Aquatic").prop("checked", false);
                        $("#Plant").prop("checked", false);
                        $("#Bird").prop("checked", false);
                        $("#Bug").prop("checked", false);
                        $("#Reptile").prop("checked", false);
                        $("#Dawn").prop("checked", false);
                        $("#Dusk").prop("checked", false);


                    }

                    if(classStr == "Dawn"){
                        $("#Dawn").prop("checked", true);


                        $("#Beast").prop("checked", false);
                        $("#Aquatic").prop("checked", false);
                        $("#Plant").prop("checked", false);
                        $("#Bird").prop("checked", false);
                        $("#Bug").prop("checked", false);
                        $("#Reptile").prop("checked", false);
                        $("#Mech").prop("checked", false);
                        $("#Dusk").prop("checked", false);
                    }

                    if(classStr == "Dusk"){

                        $("#Dusk").prop("checked", true);

                        $("#Beast").prop("checked", false);
                        $("#Aquatic").prop("checked", false);
                        $("#Plant").prop("checked", false);
                        $("#Bird").prop("checked", false);
                        $("#Bug").prop("checked", false);
                        $("#Reptile").prop("checked", false);
                        $("#Mech").prop("checked", false);
                        $("#Dawn").prop("checked", false);
                    }

                    // console.log(partArrS[0].abilities.length)

                    $("#Yam").prop("checked", false);
                    $("#Humorless").prop("checked", false);
                    $("#RoseBud").prop("checked", false);
                    $("#Eggshell").prop("checked", false);
                    $("#Hasagi").prop("checked", false);
                    $("#Shiitake").prop("checked", false);
                    $("#FirTrunk").prop("checked", false);
                    $("#NutCracker").prop("checked", false);

                    var valueSelectArray = []

                    var queryEyesStr;
                    var queryEarsStr;
                    var queryBackStr;
                    var queryMouthStr;
                    var queryHornStr;
                    var queryTailStr;


                    partArrS.forEach((item,index)=>{

                        if(item.type == "Eyes"){
                            // console.log("当前技能ID",item.id)
                            $("#eye").prop("checked", true);
                            $("#input_eye").val(item.id)
                            // $("#earsSpan").text(item.name)
                            queryEyesStr = item.name
                            eyeID = item.id
                            valueSelectArray.push(eyeID)
                        }

                        if(item.type == "Ears"){
                            // console.log("当前技能ID",item.id)
                            $("#ear").prop("checked", true);
                            $("#input_ear").val(item.id)
                            queryEarsStr = item.name
                            earID = item.id
                            valueSelectArray.push(earID)
                        }


                        if(item.abilities.length !== 0){


                            if(item.type == "Back"){
                                // console.log("当前技能ID",item.id)
                                bacID = item.id
                                $("#input_back").val(item.id)
                                queryBackStr = item.name
                                $("#back").prop("checked", true);

                                valueSelectArray.push(bacID)


                                $("#abilities_title1").text(item.abilities[0].name)

                                $("#abilities_detail1").text(item.abilities[0].description)
                                $("#abilities_image1").attr('src',item.abilities[0].backgroundUrl);
                                $("#abilities_image_small1").attr('src',item.abilities[0].effectIconUrl);


                                // if(item.id == "back-risky-beast"){  //黄颜色的背部
                                //   $("#Hasagi").prop("checked", true);
                                // }else{
                                //   $("#Shiitake").prop("checked", true);
                                // }
                            }

                            if(item.type == "Mouth"){

                                mouthID = item.id
                                $("#input_mouth").val(item.id)
                                queryMouthStr = item.name
                                $("#mouth").prop("checked", true);
                                valueSelectArray.push(mouthID)

                                $("#abilities_title2").text(item.abilities[0].name)
                                $("#abilities_detail2").text(item.abilities[0].description)
                                $("#abilities_image2").attr('src',item.abilities[0].backgroundUrl);
                                $("#abilities_image_small2").attr('src',item.abilities[0].effectIconUrl);


                                // // console.log("当前技能ID",item.id)
                                // if(item.id == "mouth-humorless"){
                                //   $("#Humorless").prop("checked", true);
                                // }else{
                                //   $("#NutCracker").prop("checked", true);
                                // }
                            }

                            if(item.type == "Horn"){
                                hornID = item.id
                                $("#input_horn").val(item.id)
                                queryHornStr = item.name
                                $("#horn").prop("checked", true);
                                valueSelectArray.push(hornID)

                                $("#abilities_title3").text(item.abilities[0].name)
                                $("#abilities_detail3").text(item.abilities[0].description)
                                $("#abilities_image3").attr('src',item.abilities[0].backgroundUrl);
                                $("#abilities_image_small3").attr('src',item.abilities[0].effectIconUrl);


                                // console.log("当前技能ID",item.id)
                                // if(item.id == "horn-rose-bud"){
                                //   $("#RoseBud").prop("checked", true);
                                // }else{
                                //   $("#Eggshell").prop("checked", true);
                                // }
                            }

                            // if(item.type == "Beast"){
                            //   // console.log("当前技能ID",item.id)
                            //
                            // }

                            if(item.type == "Tail"){
                                tailID = item.id
                                queryTailStr = item.name
                                $("#input_tail").val(item.id)
                                $("#tail").prop("checked", true);
                                valueSelectArray.push(tailID)

                                $("#abilities_title4").text(item.abilities[0].name)
                                $("#abilities_detail4").text(item.abilities[0].description)
                                $("#abilities_image4").attr('src',item.abilities[0].backgroundUrl);
                                $("#abilities_image_small4").attr('src',item.abilities[0].effectIconUrl);


                                // if(item.id == "tail-yam"){
                                //   $("#Yam").prop("checked", true);
                                // }else{
                                //   $("#FirTrunk").prop("checked", true);
                                // }
                            }
                        }




                        demo2.setValue(valueSelectArray)



                    })


                    // console.log("valueSelectArray",valueSelectArray)




                    form.render('checkbox')
                    layer.closeAll()


                    //查完能力接着 查找相似
                    // var indexTableLoad = layer.load(1, {
                    //     shade: [0.1,'#fff'] //0.1透明度的白色背景
                    // });

                    //因数据加载可能存在不及时回来,得开启定时器进行判断
                    var timerSetInterval = setInterval(()=>{

                        let selectArr = demo2.getValue("valueStr");
                        selectArr =  selectArr.replaceAll(",", "@");
                        // console.log("selectArr",selectArr,selectArr.length)


                        if(selectArr != "" || selectArr.length != 0){

                            // console.log("selectArr不为空!",)
                            //selectArr不为空,则清除定时器,并进行页面重载
                            clearInterval(timerSetInterval)
                            var data = form.val('classform');

                            // console.log(data)

                            classStr =""

                            if(data.Beast == "on"){
                                // console.log("进来")
                                classStr = classStr + "Beast" + "@"
                            }

                            if(data.Aquatic == "on"){
                                classStr = classStr + "Aquatic" + "@"
                            }

                            if(data.Plant == "on"){
                                classStr = classStr + "Plant" + "@"
                            }

                            if(data.Bird == "on"){
                                classStr = classStr + "Bird" + "@"
                            }

                            if(data.Bug == "on"){
                                classStr = classStr + "Bug" + "@"
                            }

                            if(data.Reptile == "on"){
                                classStr = classStr + "Reptile" + "@"
                            }

                            if(data.Mech == "on"){
                                classStr = classStr + "Mech" + "@"
                            }

                            if(data.Dawn == "on"){
                                classStr = classStr + "Dawn" + "@"
                            }

                            if(data.Dusk == "on"){
                                classStr = classStr + "Dusk" + "@"
                            }

                            classStr = classStr.substring(0,classStr.length-1);

                            //执行重载
                            table.reload('systemLog', {
                                page: {
                                    curr: 1 //重新从第 1 页开始
                                },
                                url : requertUrl+"/setInformation"
                                ,where: {
                                    classes: classStr,
                                    parts:selectArr
                                } ,
                                parseData: function(res){ //res 即为原始返回的数据
                                    console.log("当前res",res)
                                    console.log("当前查找ID相似",currQueryAxiesID)

                                    if(res.result === null || res.result == "null"){
                                        // layer.close(indexTableLoad)
                                        console.log("res.result为null的情况,看返回来的数据--",res)
                                        layer.msg('查找相似失败,res.result为null,请重新查找相似~', {icon: 2});
                                        return {
                                            "code":200,
                                            "result": [] //解析数据列表
                                        };
                                    }else{
                                        if(res.result.data === undefined || res.result.data == 'undefined' || res.result.data === null || res.result.data == "null" ){

                                            // layer.close(indexTableLoad)
                                            layer.msg('查找相似失败,res.result.data为null,请重新查找相似~', {icon: 2});
                                            console.log("res.result.data为null的情况,看返回来的数据--",res)

                                        }else{

                                            console.log("看返回来的数据",res.result.data)


                                            if(res.result.data.hasOwnProperty('axies') && !res.result.data.hasOwnProperty('errors')){
                                                //这里有点小问题
                                                totalNumValue = res.result.data.axies.total
                                                $("#totalNum").text(res.result.data.axies.total)
                                                // layer.close(indexTableLoad)
                                                return {
                                                    "code":200,
                                                    "result": res.result.data.axies.results //解析数据列表
                                                };
                                            }else{
                                                // layer.close(indexTableLoad)
                                                $("#totalNum").text("总数异常错误")
                                                return {
                                                    "code":200,
                                                    "result": res.result.data.errors //解析数据列表
                                                };
                                            }

                                        }
                                    }






                                },
                                done: function(res, curr, count){
                                    if(res.result === null || res.result == "null"){
                                        // layer.close(indexTableLoad)
                                        console.log("res.result为null的情况,看返回来的数据--",res)
                                        layer.msg('查找相似失败,res.result为null,请重新查找相似~', {icon: 2});
                                    }else{
                                        layer.msg('查找相似已查询成功~', {icon: 1});
                                        // layer.close(indexTableLoad)
                                    }

                                },
                                error:function(error,res){
                                    console.log("reload--error",error)
                                    console.log("reload--res",res)
                                    // layer.msg('查找相似已查询成功~', {icon: 1});
                                    // layer.close(indexTableLoad)
                                },
                            });



                        }else{ //selectArr为空,则继续进行定时任务查找
                            // console.log("selectArr为空!",)
                        }

                    },1000)


                    var requestdata = "w="+JSON.stringify({"data":[{"class":classStr,"eyes":queryEyesStr,"ears":queryEarsStr,"back":queryBackStr,"mouth":queryMouthStr,"horn":queryHornStr,"tail":queryTailStr}]})

                    // console.log(requestdata)
                    //查询模板是否存在
                    $.ajax({
                        url: requertUrl+"/IfShopping",
                        dataType: 'json',
                        type: 'POST',
                        data:requestdata,
                        // contentType:"application/x-www-form-urlencoded",
                        // contentType: "application/json; charset=utf-8",
                        // data: JSON.stringify(requestdata),
                        success: function (dataArray) {

                            // console.log(dataArray)
                            if (dataArray.code != 200) {

                                // console.log(dataArray.msg)
                                // layer.msg(dataArray.msg);
                                $("#shuoming").text("模板不存在")
                                layer.msg("模板不存在！", {icon: 1});
                                $("#templateContext").val("")
                                return false;

                            }



                            layer.msg("此模板已经存在！", {icon: 2});

                            $("#shuoming").text("此模板已经存在！")
                            var currTempDatas = dataArray.result

                            // currTempDatas

                            $('#templateList').find('option:contains(' + currTempDatas.remark + ')').prop('selected',true);
                            //重新渲染 固定写法
                            form.render("select");


                            currDatas_template = currTempDatas

                            var filecontent = "# 以下信息为模板的信息" + "\n"
                            filecontent = filecontent + "类别 = " + currTempDatas.kinds + "\n"
                            filecontent = filecontent + "眼睛 = " + currTempDatas.eyes+ "\n"
                            filecontent = filecontent + "耳朵 = " + currTempDatas.ears + "\n"
                            filecontent = filecontent + "背 = " + currTempDatas.back + "\n"
                            filecontent = filecontent + "牙 = " + currTempDatas.mouth+ "\n"
                            filecontent = filecontent + "角 = " + currTempDatas.horn+ "\n"
                            filecontent = filecontent + "尾 = " + currTempDatas.tail+ "\n"
                            filecontent = filecontent + "价格(ETH) = " + currTempDatas.eth_price+ "\n"
                            filecontent = filecontent + "价格(USD) = " + currTempDatas.price+ "\n"

                            $("#templateContext").val(filecontent)



                            //如果模板已存在后就删除市场中的ID
                            $.ajax({
                                url: requertUrl+"/delRec?id="+currParentDatas.id,
                                dataType: 'json',
                                type: 'GET',
                                success: function (dataArray) {

                                    // console.log(dataArray)
                                    if (dataArray.code != 200) {

                                        // console.log(dataArray.msg)
                                        // layer.msg(dataArray.msg);

                                        return false;

                                    }

                                    layer.closeAll();
                                    // window.parent.location.reload();

                                }
                            })

                        }
                    })

                },
                error : function(XMLHttpRequest,status){ //请求失败执行函数

                    console.log("ajax-error",status)
                    layer.close(indexLoad)
                    layer.msg('查询错误,axie服务器没响应,请重新查询！', {icon: 2});


                },
                complete : function(XMLHttpRequest,status){ //请求完成后最终执行参数

                    // console.log("status",status)
                    if(status == 'timeout'){//超时,status还有success,error等值的情况

                        layer.close(indexLoad)
                        layer.msg('查询失败,axie服务器没响应,请重新查询！', {icon: 2});
                        return false
                        // alert("超时");

                    }

                },



            });


            return false
        })

        //重载相似数据
        $("#searchBtn").click(function () {
            //因数据加载可能存在不及时回来,得开启定时器进行判断
            var timerSetInterval = setInterval(()=>{

                let selectArr = demo2.getValue("valueStr");
                selectArr =  selectArr.replaceAll(",", "@");
                // console.log("selectArr",selectArr,selectArr.length)


                if(selectArr != "" || selectArr.length != 0){

                    // console.log("selectArr不为空!",)
                    //selectArr不为空,则清除定时器,并进行页面重载
                    clearInterval(timerSetInterval)
                    var data = form.val('classform');

                    // console.log(data)

                    classStr =""

                    if(data.Beast == "on"){
                        // console.log("进来")
                        classStr = classStr + "Beast" + "@"
                    }

                    if(data.Aquatic == "on"){
                        classStr = classStr + "Aquatic" + "@"
                    }

                    if(data.Plant == "on"){
                        classStr = classStr + "Plant" + "@"
                    }

                    if(data.Bird == "on"){
                        classStr = classStr + "Bird" + "@"
                    }

                    if(data.Bug == "on"){
                        classStr = classStr + "Bug" + "@"
                    }

                    if(data.Reptile == "on"){
                        classStr = classStr + "Reptile" + "@"
                    }

                    if(data.Mech == "on"){
                        classStr = classStr + "Mech" + "@"
                    }

                    if(data.Dawn == "on"){
                        classStr = classStr + "Dawn" + "@"
                    }

                    if(data.Dusk == "on"){
                        classStr = classStr + "Dusk" + "@"
                    }

                    classStr = classStr.substring(0,classStr.length-1);

                    //执行重载
                    table.reload('systemLog', {
                        page: {
                            curr: 1 //重新从第 1 页开始
                        },
                        url : requertUrl+"/setInformation"
                        ,where: {
                            classes: classStr,
                            parts:selectArr
                        } ,
                        parseData: function(res){ //res 即为原始返回的数据
                            console.log("当前res",res)
                            console.log("当前查找ID相似",currQueryAxiesID)

                            if(res.result === null || res.result == "null"){
                                // layer.close(indexTableLoad)
                                console.log("res.result为null的情况,看返回来的数据--",res)
                                layer.msg('查找相似失败,res.result为null,请重新查找相似~', {icon: 2});
                                return {
                                    "code":200,
                                    "result": [] //解析数据列表
                                };
                            }else{
                                if(res.result.data === undefined || res.result.data == 'undefined' || res.result.data === null || res.result.data == "null" ){

                                    // layer.close(indexTableLoad)
                                    layer.msg('查找相似失败,res.result.data为null,请重新查找相似~', {icon: 2});
                                    console.log("res.result.data为null的情况,看返回来的数据--",res)

                                }else{

                                    console.log("看返回来的数据",res.result.data)


                                    if(res.result.data.hasOwnProperty('axies') && !res.result.data.hasOwnProperty('errors')){
                                        //这里有点小问题
                                        totalNumValue = res.result.data.axies.total
                                        $("#totalNum").text(res.result.data.axies.total)
                                        // layer.close(indexTableLoad)
                                        return {
                                            "code":200,
                                            "result": res.result.data.axies.results //解析数据列表
                                        };
                                    }else{
                                        // layer.close(indexTableLoad)
                                        $("#totalNum").text("总数异常错误")
                                        return {
                                            "code":200,
                                            "result": res.result.data.errors //解析数据列表
                                        };
                                    }

                                }
                            }






                        },
                        done: function(res, curr, count){
                            if(res.result === null || res.result == "null"){
                                // layer.close(indexTableLoad)
                                console.log("res.result为null的情况,看返回来的数据--",res)
                                layer.msg('查找相似失败,res.result为null,请重新查找相似~', {icon: 2});
                            }else{
                                layer.msg('查找相似已查询成功~', {icon: 1});
                                // layer.close(indexTableLoad)
                            }

                        },
                        error:function(error,res){
                            console.log("reload--error",error)
                            console.log("reload--res",res)
                            // layer.msg('查找相似已查询成功~', {icon: 1});
                            // layer.close(indexTableLoad)
                        },
                    });



                }else{ //selectArr为空,则继续进行定时任务查找
                    // console.log("selectArr为空!",)
                }

            },1000)

            return false
        })



    });






</script>
</body>
</html>
